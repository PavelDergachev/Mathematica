(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    589812,      11088]
NotebookOptionsPosition[    571712,      10758]
NotebookOutlinePosition[    572083,      10774]
CellTagsIndexPosition[    572040,      10771]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Biot-Savart magnetic field calculations for wires", "Title",
 CellChangeTimes->{{3.826518130875935*^9, 3.82651813542864*^9}, {
  3.8267073333708487`*^9, 3.8267073529174137`*^9}, {3.826870224459178*^9, 
  3.826870225144163*^9}, {3.827052296790502*^9, 
  3.8270523064581137`*^9}},ExpressionUUID->"57e47aa5-7823-4734-8141-\
ff524fd090ed"],

Cell["\[Copyright] 2021, Jan. G. Korvink", "Author",
 CellChangeTimes->{{3.826707369305122*^9, 
  3.8267073951174307`*^9}},ExpressionUUID->"0a82bfa3-dd50-4edf-8142-\
008798979813"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Red", ",", 
       RowBox[{"Arrowheads", "[", "0.1", "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"Tube", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "#", "]"}], ",", 
               RowBox[{"Cos", "[", "#", "]"}], ",", "0"}], "}"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{"n", "=", "41"}], ",", "0", ",", 
                RowBox[{"-", "1"}]}], "]"}], "*", 
              RowBox[{"(", 
               RowBox[{"2", 
                RowBox[{"\[Pi]", "/", "n"}]}], ")"}]}], ")"}]}], ",", 
           "0.02"}], "]"}], ",", "0.001"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<i\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1.2", ",", "0"}], "}"}]}], "]"}], ",", "Blue", 
       ",", 
       RowBox[{"Arrowheads", "[", "0.05", "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
         "0.01"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0.5", ",", "0"}], "}"}]}], "}"}], ",", 
         "0.01"}], "]"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0.5"}], "}"}]}], "}"}], ",", 
         "0.01"}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<x\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.7", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<y\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.7", ",", "0"}], "}"}]}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<z\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0.7"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "Black", ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"5", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
             RowBox[{"Cos", "[", 
              RowBox[{"5", 
               RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", "0"}], "}"}]}], 
          "}"}], ",", "0.01"}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<a\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"1.1", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"5", 
              RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"5", 
              RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", "0"}], "}"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"1.2", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Sin", "[", 
               RowBox[{"7", 
                RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
              RowBox[{"Cos", "[", 
               RowBox[{"7", 
                RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", "1"}], "}"}]}]}], 
          "}"}], ",", "0.01"}], "]"}], ",", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<{r,z}\>\"", ",", "Large"}], "]"}], ",", 
         RowBox[{"1.3", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", 
             RowBox[{"7", 
              RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", 
            RowBox[{"Cos", "[", 
             RowBox[{"7", 
              RowBox[{"\[Pi]", "/", "4"}]}], "]"}], ",", "1"}], "}"}]}]}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
     RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "g", "]"}]}], "Input",
 CellChangeTimes->{{3.826424590010236*^9, 3.826424600521996*^9}, {
   3.826424660272016*^9, 3.826424819625876*^9}, {3.826424871937355*^9, 
   3.8264249235028276`*^9}, {3.8264249695490847`*^9, 3.826425382411393*^9}, {
   3.826425419955652*^9, 3.826425454084753*^9}, {3.826425484701437*^9, 
   3.826425532184968*^9}, {3.82642556960227*^9, 3.826425582559176*^9}, {
   3.826425663061514*^9, 3.826425683970354*^9}, {3.826425752297917*^9, 
   3.826425846615888*^9}, {3.826425900750926*^9, 3.826426036434579*^9}, 
   3.8264261813638353`*^9, {3.826426219869856*^9, 3.826426326919394*^9}, {
   3.826431050440275*^9, 3.826431059612445*^9}},
 CellLabel->
  "In[381]:=",ExpressionUUID->"a035373d-97c2-4e0e-b3e9-26dbba22d4ac"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[1, 0, 0], Arrowheads[0.1], Arrow3DBox[TubeBox[CompressedData["
1:eJxTTMoPSmVmYGBgBGItIAaxUcEHexiLUXsvI3PX4f3RNrku/+a/h4vv3XP/
ZbL/5f0LmRrULJvewcUXpfE9eZ56Z79a4r3k5LVv4OJOMWfXMmU+2r/5zF3D
Kp1XcPG2aJnomQbP9ntWCPk28z2Hi5/vl+bkKn653zPZ+apR2mO4+If2yJ1H
Zd7sbwz0Uv026R5cXOLZg90XZd/tr10zoVtw0VW4eL288ET1rPf76+4sT9wT
dwIufnfqZ8G/P9/vD5olXpk1ZzFcfGP5S93PJ9/vZ9lZNfNJ9N79MHGDMw2q
Wrff7f+/se5nydcLcPGTn4+fsDJ+u3+N+DwLPb1bcPF+9SsPRe682n+o0ffY
85SHcPHe+o9TDj9+vv/t8Rz5SK+ncPFXV5xlJGOe7BfYPFGYa8MLuPimW9U3
nKMe7D+24orcjMbXcPGGtv6CeW+u7z+vf26e5Lq3cPFP7k1HfLXO7j9mY+XX
rPEeLr7bqzxy94zN+2WzGLu+PccQt0cXh5pjj24O1F57dHuh7rRHdyfUX/bo
/oKGgz16OEDDzR493KDhbI8eztB4sUePF2g82qPHIzTe7dHjHZpO7NHTCTRd
2aOnK2g6tEdPh9B0a4+ebqHp3B49nUPzhT16voDmI3v0fATNd/bo+Q6aT+3R
8ykqQORrAL9LX8A=
     "], 0.02], 0.001], Text3DBox[
     StyleBox["\<\"i\"\>",
      StripOnInput->False,
      FontSize->Large], {0, 1.2, 0}]}, 
   {RGBColor[0, 0, 1], Arrowheads[0.05], 
    Arrow3DBox[{{0, 0, 0}, {0.5, 0, 0}}, 0.01], 
    Arrow3DBox[{{0, 0, 0}, {0, 0.5, 0}}, 0.01], 
    Arrow3DBox[{{0, 0, 0}, {0, 0, 0.5}}, 0.01], Text3DBox[
     StyleBox["\<\"x\"\>",
      StripOnInput->False,
      FontSize->Large], {0.7, 0, 0}], Text3DBox[
     StyleBox["\<\"y\"\>",
      StripOnInput->False,
      FontSize->Large], {0, 0.7, 0}], Text3DBox[
     StyleBox["\<\"z\"\>",
      StripOnInput->False,
      FontSize->Large], {0, 0, 0.7}], 
    {GrayLevel[0], 
     Arrow3DBox[
      NCache[{{0, 0, 0}, {-2^Rational[-1, 2], -2^Rational[-1, 2], 0}}, {{0, 0,
         0}, {-0.7071067811865475, -0.7071067811865475, 0}}], 0.01], Text3DBox[
      StyleBox["\<\"a\"\>",
       StripOnInput->False,
       FontSize->Large], {-0.7778174593052023, -0.7778174593052023, 0.}], 
     Arrow3DBox[{{0, 0, 0}, {-0.8485281374238569, 0.8485281374238569, 1.2}}, 
      0.01], Text3DBox[
      StyleBox["\<\"{r,z}\"\>",
       StripOnInput->False,
       FontSize->Large], {-0.9192388155425117, 0.9192388155425117, 1.3}]}}},
  Axes->False,
  Boxed->False,
  ViewPoint->{1.3, -2.4, 2.},
  ViewVertical->{0., 0., 1.}]], "Output",
 CellChangeTimes->{3.826431059892618*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"e7962912-5e5d-4f09-a947-92531aacd35e"]
}, {2}]],

Cell[CellGroupData[{

Cell["Notes", "Chapter",
 CellChangeTimes->{{3.826618787618185*^9, 3.8266187882429113`*^9}, {
  3.8272322481511374`*^9, 
  3.827232248940431*^9}},ExpressionUUID->"5a3e36a5-c5a2-404c-a4c5-\
5930e69c8bd8"],

Cell["\<\
Todos:

1. Physics: \[LineSeparator]Force on wire due to field of rest of coil.

2. Postprocessing: 
Excitation spectrum in rotating frame. Phase profile. FID profile.
Phase accumulation from pulse, with realistic pulse shapes, for every point \
in a region of interest. Subsequent FID profile.
Inductance of loop

3. Fundamentals:
Multipole expansion for evaluation of an arbitrary wire shape, especially, a \
spline shape.
\
\>", "Text",
 CellChangeTimes->{{3.827232253588099*^9, 
  3.827232523669755*^9}},ExpressionUUID->"00df9528-5e65-4011-8bde-\
279622ded739"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code", "Chapter",
 CellChangeTimes->{{3.826618787618185*^9, 
  3.8266187882429113`*^9}},ExpressionUUID->"e20fa466-8504-4b14-af6d-\
104f7a9eccdc"],

Cell[CellGroupData[{

Cell["User accessible symbols", "Section",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.8266293201431932`*^9, 
  3.826629324984172*^9}},ExpressionUUID->"0ce60eff-e4c5-44fd-aa12-\
d993c7590615"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeginPackage", "[", "\"\<BiotSavart`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706328676777`*^9}, {3.827052274386117*^9, 3.827052277659134*^9}},
 CellLabel->
  "(Debug) In[11]:=",ExpressionUUID->"f3a404b4-0017-4116-b981-321c7a40ed54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BiotSavart", "::", "usage"}], "=", 
   "\"\<BiotSavart is a package to specify current carrying coils and \
evaluate their field values. The package works with wire objects \
(\!\(\*StyleBox[\"WireSegment\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireRectangle\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireCurcularArd\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireEllipse\",FontSlant->\"Italic\
\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireEllipsoidalArc\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireSpline\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireGroup\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireRepeated\",FontSlant->\"\
Italic\"]\)), constructor functions \
(\!\(\*StyleBox[\"MakeWireSegment\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"MakeWireRectangle\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"MakeWireSpline\",FontSlant->\"\
Italic\"]\), etc., as well as \
\!\(\*StyleBox[\"TranslateWire\",FontSlant->\"Italic\"]\) to displace the \
origin of a wire), wire plotting functions \
(\!\(\*StyleBox[\"DrawWire\",FontSlant->\"Italic\"]\)) that take wire \
specifications as an argument, and field evaluation functions \
(\!\(\*StyleBox[\"MagneticVectorPotential\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"MagneticInduction\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"MagneticInductionGradient\",\
FontSlant->\"Italic\"]\)) that require both a wire specification, and an \
evaluation point. Please consult the individual functions for further \
details.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.826870812056878*^9}, {
   3.826871601495573*^9, 3.826871603101261*^9}, {3.827125430708056*^9, 
   3.827125742122382*^9}, {3.827125780865266*^9, 3.827125883234447*^9}, {
   3.827125944579048*^9, 3.8271260044733458`*^9}, {3.827126120788645*^9, 
   3.827126126109783*^9}},
 CellLabel->
  "(Debug) In[12]:=",ExpressionUUID->"41bbb72c-1aca-412e-8f5e-ab6667bbd6de"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"BiotSavart\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is not \
of the form symbol::name or symbol::name::language.\"",2,12,13,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646453854228*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[12]:=",ExpressionUUID->"0a80e8b1-73e9-4f6c-a88e-04c59e8b5adc"]
}, Open  ]],

Cell["Wire object definitions", "Subsection",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826870991129889*^9}, {
  3.8268710474610147`*^9, 
  3.8268710495437307`*^9}},ExpressionUUID->"7dcf11fb-5eab-458c-bbd2-\
6dc4ea65345f"],

Cell[CellGroupData[{

Cell["Wire object options", "Subsection",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826870991129889*^9}, {
  3.8268710474610147`*^9, 3.8268710495437307`*^9}, {3.826871256382469*^9, 
  3.826871257280827*^9}},ExpressionUUID->"e8d9f847-c066-4a31-b0a2-\
db727e7b61fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireColor", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\) is a symbol \
rule for the color of a loop. Used in drawing the loop. See \
\!\(\*StyleBox[\"DrawCurrentLoop\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\).\>\"\
"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.826870812056878*^9}, {
   3.826871601495573*^9, 3.826871603101261*^9}, {3.827125430708056*^9, 
   3.827125446409803*^9}},
 CellLabel->
  "(Debug) In[13]:=",ExpressionUUID->"df74079b-22cc-457e-9ad7-e89ed549a642"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"WireColor\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is not \
of the form symbol::name or symbol::name::language.\"",2,13,14,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8276464540159893`*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[13]:=",ExpressionUUID->"80534342-525f-4cf3-b453-4f661e6bf504"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wire object definitions", "Subsubsection",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826870991129889*^9}, {
   3.8268710474610147`*^9, 3.8268710495437307`*^9}, 
   3.827572521711286*^9},ExpressionUUID->"d581de2c-533a-407a-90ec-\
4cec3b94c940"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireSegment", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireSegment\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\
\(\*SubscriptBox[StyleBox[\"p\",FontSlant->\"Italic\"], \
\"1\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(2\)]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"...\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(n\)]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"colorspec\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"]\",FontSlant->\"Italic\"]\) defines a \
\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\) carrying wire with at \
least one straight segment defined by \!\(\*SubscriptBox[\(p\), \(1\)]\) and \
\!\(\*SubscriptBox[\(p\), \(2\)]\), and possibly all the way to \
\!\(\*SubscriptBox[StyleBox[\"p\",FontSlant->\"Italic\"], \"n\"]\).  \
\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)The \
\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\) of the wire is specified by \
a rule: \!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\
->\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\".\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)See \
\!\(\*StyleBox[\"Make\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireSegment\"\
,FontSlant->\"Italic\"]\)[] for a constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707713628683`*^9}, 
   3.826871053783627*^9, {3.826871394939498*^9, 3.8268713995152884`*^9}, {
   3.8268714544065943`*^9, 3.826871455209544*^9}, {3.826871539660717*^9, 
   3.8268715723536987`*^9}, {3.826871604159527*^9, 3.8268716079655523`*^9}, 
   3.8268718397324753`*^9, {3.8268732020976553`*^9, 3.826873210950778*^9}, {
   3.8270473737035837`*^9, 3.827047375375152*^9}, 3.827047563517639*^9, {
   3.827051319713921*^9, 3.827051338638267*^9}, {3.8270514067413893`*^9, 
   3.827051428005712*^9}, {3.827568346156108*^9, 3.827568413946926*^9}, {
   3.8275684461832037`*^9, 3.827568476916029*^9}, {3.8275685116505823`*^9, 
   3.8275685629508553`*^9}, 3.82757252171154*^9},
 CellLabel->
  "(Debug) In[14]:=",ExpressionUUID->"9683fd6e-a31c-4e48-bc61-687b3fa95307"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireRectangle", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"translation\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"direction\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"xlength\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"ywidth\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"angle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"\[Rule]\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) defines \
a rectangular current loop in space. The current loop is defined to have its \
edges defined along the coordinate x and y axes, which are rotated \
anti-clockwise by the specified angle before the surface normal is tilted to \
direction. The current loop's normal points in the specified direction. The \
color of a loop is specified by a rule: \
\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\[Rule]\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\). \
See MakeWireRectangle[] for a constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707713628683`*^9}, 
   3.826871053783627*^9, {3.826871394939498*^9, 3.8268713995152884`*^9}, {
   3.8268714544065943`*^9, 3.826871455209544*^9}, {3.826871539660717*^9, 
   3.8268715723536987`*^9}, {3.826871604159527*^9, 3.8268716079655523`*^9}, 
   3.8268718397324753`*^9, {3.8268732020976553`*^9, 3.826873210950778*^9}, {
   3.8270473737035837`*^9, 3.827047375375152*^9}, {3.827047563517639*^9, 
   3.827047565383933*^9}, 3.827051341958795*^9, 3.827572521711789*^9},
 CellLabel->
  "(Debug) In[15]:=",ExpressionUUID->"1d401c5e-f5ac-4a06-afd3-5c7e3846f78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireCircle", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"translation\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"direction\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"colorspec\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) defines a circular current \
loop in space. The circle's surface normal points in the specified direction. \
The wire circle has a specified \!\(\*StyleBox[\"radius\",FontSlant->\"Italic\
\"]\). The \!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\) of the wire is \
specified by a rule: \
\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"->\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\). \
See \!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"Italic\"]\)[] for a \
constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707713628683`*^9}, 
   3.826871053783627*^9, {3.826871394939498*^9, 3.8268713995152884`*^9}, {
   3.8268714544065943`*^9, 3.826871455209544*^9}, {3.826871539660717*^9, 
   3.8268715723536987`*^9}, {3.826871604159527*^9, 3.8268716079655523`*^9}, 
   3.8268718397324753`*^9, {3.8268732020976553`*^9, 3.826873210950778*^9}, {
   3.8270473737035837`*^9, 3.827047375375152*^9}, {3.827047563517639*^9, 
   3.827047565383933*^9}, 3.827051344964511*^9, 3.82757252171196*^9},
 CellLabel->
  "(Debug) In[16]:=",ExpressionUUID->"4456894a-abcb-4159-b62a-aaebaf3e18b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireCircularArc", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"translation\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
SubscriptBox[StyleBox[\"\[Theta]\",FontSlant->\"Italic\"], \"1\"],FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[SubscriptBox[StyleBox[\"\[Theta]\",FontSlant->\"Italic\"], \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"colorspec\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"]\",FontSlant->\"Italic\"]\) defines a circular wire arc. See \!\(\
\*StyleBox[\"MakeWireCircularArc\",FontSlant->\"Italic\"]\)[] for a \
constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047588941515*^9}, {3.827051172425742*^9, 3.827051179443799*^9}, {
   3.827051224650393*^9, 3.8270512705144777`*^9}, {3.827051350170891*^9, 
   3.827051351187921*^9}, 3.827572521712077*^9},
 CellLabel->
  "(Debug) In[17]:=",ExpressionUUID->"6b8c7a91-507e-4bfe-a8ee-efe2a20edfc9"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"WireCircularArc\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) \
is not of the form symbol::name or symbol::name::language.\"",2,17,15,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454165779*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[17]:=",ExpressionUUID->"3f7d999c-262f-4c9d-be06-7774f860ccd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireEllipse", "::", "usage"}], "=", 
   "\"\<NOT YET DEFINED. See \
\!\(\*StyleBox[\"MakeWireEllipse\",FontSlant->\"Italic\"]\)[] for a \
constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047590915637*^9}, {3.827051137032823*^9, 3.827051166375845*^9}, 
   3.8275725217122602`*^9},
 CellLabel->
  "(Debug) In[18]:=",ExpressionUUID->"f533156b-7fb3-4ca4-803b-a401a3dcf823"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"WireEllipse\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is \
not of the form symbol::name or symbol::name::language.\"",2,18,16,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454183228*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[18]:=",ExpressionUUID->"469a7682-98c5-4280-863c-ba6cbd59a06b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireEllipsoidalArc", "::", "usage"}], "=", 
   "\"\<NOT YET DEFINED. See \
\!\(\*StyleBox[\"MakeWireEllipsoidalArc\",FontSlant->\"Italic\"]\)[] for a \
constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047592597269*^9}, {3.827051116526845*^9, 3.827051158827024*^9}, 
   3.8275725217124157`*^9},
 CellLabel->
  "(Debug) In[19]:=",ExpressionUUID->"86c66f95-6aef-44ea-a7cf-8e1a071f1aef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireSpline", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireSpline\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[SubscriptBox[\"p\", \
\"1\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"3\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"4\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"colorspec\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"]\",FontSlant->\"Italic\"]\) defines a spline shaped wire in \
space. The four control points \
\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\"\
, \"1\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"3\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"p\", \
\"4\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\) \
are specified with 3 cartesian coordinates. The \
\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\) of the wire is specified by \
a rule: \!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\
->\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",FontSlant->\"Italic\"]\)\
. See \!\(\*StyleBox[\"MakeWireSpline\",FontSlant->\"Italic\"]\)[] for a \
constructor.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047592597269*^9}, {3.827050915370295*^9, 3.827051094764205*^9}, {
   3.8271186849944563`*^9, 3.827118761008851*^9}, 3.827572521712549*^9},
 CellLabel->
  "(Debug) In[20]:=",ExpressionUUID->"e131cbe1-4d54-4ccb-8957-427f8f85c595"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"WireSpline\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is not \
of the form symbol::name or symbol::name::language.\"",2,20,17,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8276464542504683`*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[20]:=",ExpressionUUID->"e4d06b8c-fc82-4302-b42b-077b54fdc928"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireGroup", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireGroup\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\
[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[SubscriptBox[\"w\", \"1\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"w\", \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"...\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[SubscriptBox[\"w\", \"n\"],FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant-\
>\"Italic\"]\) groups a list of two or more wire objects into a group that \
will be treated as a unit for the purposes of drawing or field computation.\>\
\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047592597269*^9}, {3.827050915370295*^9, 3.827051094764205*^9}, {
   3.8271186849944563`*^9, 3.827119021663872*^9}, 3.827572521712645*^9},
 CellLabel->
  "(Debug) In[21]:=",ExpressionUUID->"61f90669-0900-47e0-b5fc-6b4a58cbbe86"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"WireRepeated", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"WireRepeated\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"w\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"dx\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\"dy\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"dz\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"]\",FontSlant->\"Italic\"]\) builds a composite object that is \
repeated \!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\) times with the \
provided spatial offset \
\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"dx\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"dy\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"dz\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\".\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)Any wire object, including a grouped or repeated \
object, can be provided as argument.\>\""}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047592597269*^9}, {3.827050915370295*^9, 3.827051094764205*^9}, {
   3.8271186849944563`*^9, 3.827119021663872*^9}, {3.8275686605542583`*^9, 
   3.827568664509163*^9}, 3.827572521712763*^9},
 CellLabel->
  "(Debug) In[22]:=",ExpressionUUID->"28d475b7-8fdb-40f1-9ed0-6dfa62d25f7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"VectorPotentialMultipole", "::", "usage"}], "=", 
    "\"\<VectorPotentialMultipole[{\!\(\*SubscriptBox[\(c\), \
\(x\)]\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \
\(z\)]\)}, \!\(\*SubscriptBox[\(r\), \(i\)]\), \!\(\*SubscriptBox[\(r\), \
\(o\)]\), {\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}] defines the multipole expansion of the vector potential of a wire \
object relative to a centre {\!\(\*SubscriptBox[\(c\), \
\(x\)]\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \
\(z\)]\)}, with inner and outer radii \!\(\*SubscriptBox[\(r\), \(i\)]\) and \
\!\(\*SubscriptBox[\(r\), \(o\)]\). At points further than the outer radius, \
only the dipole term is required. At points within the inner and outer \
radius, the entire expansion is needed. Inside the inner radius, an explicit \
formula is needed for the field. The moments are defined by \
{\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionMultipole", "::", "usage"}], "=", 
    "\"\<MagneticInductionMultipole[{\!\(\*SubscriptBox[\(c\), \
\(x\)]\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \
\(z\)]\)}, \!\(\*SubscriptBox[\(r\), \(i\)]\), \!\(\*SubscriptBox[\(r\), \
\(o\)]\), {\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}] defines the multipole expansion of the magnetic induction of a \
wire object relative to a centre {\!\(\*SubscriptBox[\(c\), \
\(x\)]\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \
\(z\)]\)}, with inner and outer radii \!\(\*SubscriptBox[\(r\), \(i\)]\) and \
\!\(\*SubscriptBox[\(r\), \(o\)]\). At points further than the outer radius, \
only the dipole term is required. At points within the inner and outer \
radius, the entire expansion is needed. Inside the inner radius, an explicit \
formula is needed for the field. The moments are defined by \
{\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradientMultipole", "::", "usage"}], "=", 
    "\"\<MagneticInductionGradientMultipole[{\!\(\*SubscriptBox[\(c\), \(x\)]\
\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \(z\)]\)}, \!\
\(\*SubscriptBox[\(r\), \(i\)]\), \!\(\*SubscriptBox[\(r\), \(o\)]\), \
{\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}] defines the multipole expansion of the magnetic induction gradient \
of a wire object relative to a centre {\!\(\*SubscriptBox[\(c\), \
\(x\)]\),\!\(\*SubscriptBox[\(c\), \(y\)]\),\!\(\*SubscriptBox[\(c\), \
\(z\)]\)}, with inner and outer radii \!\(\*SubscriptBox[\(r\), \(i\)]\) and \
\!\(\*SubscriptBox[\(r\), \(o\)]\). At points further than the outer radius, \
only the dipole term is required. At points within the inner and outer \
radius, the entire expansion is needed. Inside the inner radius, an explicit \
formula is needed for the field. The moments are defined by \
{\!\(\*SubscriptBox[\(m\), \(0\)]\),\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...\!\(\*SubscriptBox[\(m\), \
\(n\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MultipoleSegment", "::", "usage"}], "=", 
   "\"\<MultipoleSegment[m, wire] defines a multipole expansion m of a \
current carrying wire.  The multipole can be either for the vector potential, \
magnetic induction, or the magnetic induction gradient. The wire is specified \
by a wire object. MultipoleSegment[{\!\(\*SubscriptBox[\(m\), \
\(1\)]\),\!\(\*SubscriptBox[\(m\), \(2\)]\),...,\!\(\*SubscriptBox[\(m\), \(m\
\)]\)}, wire] specifies multipoles for more than one field associated with \
the wire.\>\""}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706861752157`*^9}, {3.826870731508586*^9, 3.8268707843620253`*^9}, {
   3.8270473919406567`*^9, 3.827047402448758*^9}, {3.827047571955133*^9, 
   3.827047592597269*^9}, {3.827050915370295*^9, 3.827051094764205*^9}, {
   3.8271186849944563`*^9, 3.827119021663872*^9}, {3.8275686605542583`*^9, 
   3.82756907329825*^9}, {3.827569161813808*^9, 3.827569253463118*^9}, {
   3.827569317400906*^9, 3.827569413595673*^9}, {3.8275695079635687`*^9, 
   3.827569606413249*^9}, {3.827569676488798*^9, 3.8275697329486017`*^9}, {
   3.8275700255430183`*^9, 3.827570091678649*^9}, {3.827570155499357*^9, 
   3.8275702067957363`*^9}, {3.827570252001943*^9, 3.827570505178875*^9}, 
   3.827572521712878*^9, {3.827574332901454*^9, 3.827574340717585*^9}},
 CellLabel->
  "(Debug) In[23]:=",ExpressionUUID->"06691fa0-5e71-4194-b1c5-8ea80e16b498"]
}, Open  ]],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"VectorPotentialMultipole\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\
\"}]\\) is not of the form symbol::name or symbol::name::language.\"",2,23,18,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8276464543422003`*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[23]:=",ExpressionUUID->"22331b6a-b1f1-40c8-976c-2057f58192e7"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MagneticInductionMultipole\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\
\\\"}]\\) is not of the form symbol::name or symbol::name::language.\"",2,24,
   19,17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.82764645434515*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[23]:=",ExpressionUUID->"c184371d-d96b-4820-90f9-2707d960a810"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MultipoleSegment\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) \
is not of the form symbol::name or symbol::name::language.\"",2,26,20,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8276464543469677`*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[23]:=",ExpressionUUID->"819ea485-1b12-4e12-ac37-452869be5275"],

Cell[CellGroupData[{

Cell["Wire object Constructors", "Subsubsection",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826871004220655*^9}, 
   3.8270870966901913`*^9},ExpressionUUID->"c6ce2843-591c-4595-9525-\
fd47a996d64b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireSegment", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"MakeWireSegment\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"\
Italic\"]\)\!\(\*SubscriptBox[StyleBox[\"p\",FontSlant->\"Italic\"], \"1\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(2\)]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"...\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(n\)]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"\[Rule]\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"defines\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"a\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"wire\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"  \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"as\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"a\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"set\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"of\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"straight\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"segments\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"specified\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"by\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[StyleBox[\"p\",FontSlant->\"\
Italic\"], \
\"1\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(2\)]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"...\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(n\)]\)\!\(\*StyleBox[\".\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)At least two coordinates are \
expected\!\(\*StyleBox[\".\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\"\[Rule]\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",\
FontSlant->\"Italic\"]\) specifies the colour of the line.  The function \
returns a WireSegment[] object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.8270476279000483`*^9}, {3.82705146442334*^9, 
   3.827051488191766*^9}},
 CellLabel->
  "(Debug) In[27]:=",ExpressionUUID->"718a112d-0282-4c97-bdbe-64664f568998"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeWireSegment\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) \
is not of the form symbol::name or symbol::name::language.\"",2,27,21,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454363861*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[27]:=",ExpressionUUID->"1d290950-6a0f-480d-a7e6-88c8b3d34b2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireRectangle", "::", "usage"}], "=", 
   "\"\<NOT YET DEFINED. The function returns a WireRectangle[] \
object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}},
 CellLabel->
  "(Debug) In[28]:=",ExpressionUUID->"30b83b6c-c906-4e16-ad4c-24339f089744"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeWireRectangle\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) \
is not of the form symbol::name or symbol::name::language.\"",2,28,22,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8276464544075947`*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[28]:=",ExpressionUUID->"3d566730-9a57-4f49-8d97-61b62a5aac8f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireCircle", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"opts\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\
]\",FontSlant->\"Italic\"]\) defines a planar circular current loop, with \
given radius and anti-clockwise current intensity. The loop lies in the x-y \
plane, centered at the origin. \
\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\[Rule]\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"c\",FontSlant->\"Italic\"]\) \
specifies the colour of the line. \\n \
\!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\"\
,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"position\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"opts\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) additionally specifies an offset \
of the current loop w.r.t. the origin. \\n \
\!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\"\
,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"position\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"direction\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"opts\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) additionally specifies the \
direction of the loop's surface normal. The function returns a WireCircle[] \
object.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}},
 CellLabel->
  "(Debug) In[29]:=",ExpressionUUID->"21cdad01-5032-4672-b754-06a74f5baa56"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireCircularArc", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"MakeWireCircle\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"radius\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[SubscriptBox[StyleBox[\"\[Theta]\",FontSlant->\"Italic\"], \
\"1\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[SubscriptBox[StyleBox[\"\[Theta]\",FontSlant->\"Italic\"], \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"opts\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"\
]\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\"defines\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"a\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"circular\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"arc\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"wire\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"lying\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"in\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"the\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"-\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"y\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"plane\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"whose\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"end\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"points\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"are\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"specified\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"by\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"two\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"rotation\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"angles\",FontSlant->\"Italic\"]\)\
\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"about\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"the\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"z\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"-\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"axis\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"and\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"measured\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"anti\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"-\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"clockwise\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"from\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"the\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"-\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"axis\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\".\",FontSlant->\"Italic\"]\)\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.827050178804555*^9}, {
   3.827050474417748*^9, 3.8270506341755543`*^9}, {3.827050735795907*^9, 
   3.827050771445364*^9}},
 CellLabel->
  "(Debug) In[30]:=",ExpressionUUID->"23775fd1-d8a8-40d9-b4c3-fba1c316a9bd"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeWireCircularArc\\\", \\\",\\\", \\\"usage\\\"}], \
\\\"]\\\"}]\\) is not of the form symbol::name or symbol::name::language.\"",
   2,30,23,17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454471682*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[30]:=",ExpressionUUID->"b4b7ac8a-8d59-4929-ae0d-abf7211905ac"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireEllipse", "::", "usage"}], "=", "\"\<Not defined.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.827050178804555*^9}, {
   3.827050474417748*^9, 3.8270506341755543`*^9}, {3.827050735795907*^9, 
   3.827050771445364*^9}},
 CellLabel->
  "(Debug) In[31]:=",ExpressionUUID->"c360bb40-ba36-4518-9316-ec2c1391ac3d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireEllipsoidalArc", "::", "usage"}], "=", 
   "\"\<Not defined.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.827050178804555*^9}, {
   3.827050474417748*^9, 3.8270506341755543`*^9}, {3.827050735795907*^9, 
   3.827050770216576*^9}},
 CellLabel->
  "(Debug) In[32]:=",ExpressionUUID->"b77db501-2e51-46f7-99e4-6f7cb7b925dd"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeWireEllipsoidalArc\\\", \\\",\\\", \\\"usage\\\"}], \
\\\"]\\\"}]\\) is not of the form symbol::name or symbol::name::language.\"",
   2,32,24,17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454536395*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[32]:=",ExpressionUUID->"c825032a-36c6-4e87-97e4-775eeb030991"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireSpline", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"MakeWireSpline\",FontSlant->\"Italic\"]\)[{\!\(\*\
SubscriptBox[StyleBox[\"p\",FontSlant->\"Italic\"], \
\"1\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \
\(2\)]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[StyleBox[\"p\",FontSlant->\"\
Italic\"], \
\"3\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*SubscriptBox[\(p\), \(4\)]\)}\!\(\*StyleBox[\
\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"current\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireColor\",FontSlant->\"Italic\"]\
\)\!\(\*StyleBox[\"\[Rule]\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"color\",\
FontSlant->\"Italic\"]\)] defines a Bezier spline wire with four control \
points. The first and last points lie on the line. The other two points \
control the curvature of the line, and also define the tangents at the start \
and end points. Since no compact expression is available, the field values \
for the spline are determined by numerical integration.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.8270502201977386`*^9}, {
   3.827050272180252*^9, 3.827050450500847*^9}, {3.827050890948657*^9, 
   3.827050894573043*^9}, {3.827051503378714*^9, 3.827051509476101*^9}, {
   3.827119911632468*^9, 3.827119965843926*^9}},
 CellLabel->
  "(Debug) In[33]:=",ExpressionUUID->"ebd59fa7-b9d4-422a-82df-8d15d5bada93"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireGroup", "::", "usage"}], "=", "\"\<MakeWireGroup[]\>\""}],
   ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.8270502201977386`*^9}, {
   3.827050272180252*^9, 3.827050450500847*^9}, {3.827050890948657*^9, 
   3.827050894573043*^9}, {3.827051503378714*^9, 3.827051509476101*^9}, {
   3.827119911632468*^9, 3.827119964668849*^9}, {3.827120360405267*^9, 
   3.827120361076049*^9}},
 CellLabel->
  "(Debug) In[34]:=",ExpressionUUID->"b41de1b5-3e3e-4cbf-8b67-1a1415e505ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeWireRepeated", "::", "usage"}], "=", 
   "\"\<MakeWireRepeated[]\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.8270502201977386`*^9}, {
   3.827050272180252*^9, 3.827050450500847*^9}, {3.827050890948657*^9, 
   3.827050894573043*^9}, {3.827051503378714*^9, 3.827051509476101*^9}, {
   3.827119911632468*^9, 3.827119965843926*^9}, {3.8271203122623997`*^9, 
   3.8271203215026093`*^9}, {3.827120366524804*^9, 3.827120367810239*^9}},
 CellLabel->
  "(Debug) In[35]:=",ExpressionUUID->"ca9466b3-3508-4ace-aa81-0c8f7f0721f7"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeWireRepeated\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) \
is not of the form symbol::name or symbol::name::language.\"",2,35,25,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454613*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[35]:=",ExpressionUUID->"405c772a-891e-41ec-b536-866101f11845"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"TranslateWire\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"w\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"x\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\"y\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"z\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"\
Italic\"]\) translates the wire object by the specified offset.\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.8270502201977386`*^9}, {
   3.827050272180252*^9, 3.827050450500847*^9}, {3.827050890948657*^9, 
   3.827050894573043*^9}, {3.827051503378714*^9, 3.827051509476101*^9}, {
   3.827119911632468*^9, 3.827119965843926*^9}, {3.8271203122623997`*^9, 
   3.8271203502645197`*^9}, {3.8275698152642183`*^9, 3.827570002443697*^9}, 
   3.8275701022614107`*^9},
 CellLabel->
  "(Debug) In[36]:=",ExpressionUUID->"5c067405-b2eb-4bb3-aaf7-0eb9f98ecffe"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"TranslateWire\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is \
not of the form symbol::name or symbol::name::language.\"",2,36,26,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454658606*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[36]:=",ExpressionUUID->"93301cfb-6204-4c1c-85b2-ed81bc492800"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeMultipoleSegment", "::", "usage"}], "=", 
   "\"\<MakeMultipoleSegment[s, f] defines a multipole expansion object of a \
specific field \!\(\*StyleBox[\"f\",FontSlant->\"Italic\"]\) for a given \
segment \!\(\*StyleBox[\"s\",FontSlant->\"Italic\"]\). The optional argument \
f specifies the field that will be approximated via one of the following \
strings: VectorPotential, MagneticInduction, MagneticInductionGradient, or \
All. If no argument is given, the vector potential will be defined. If more \
than one field is required, the field strings are supplied as a list. All \
specifies that all the fields are required.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, 3.826870808357587*^9, {3.826871400942257*^9, 
   3.826871403256472*^9}, 3.826871456145104*^9, {3.82687160982654*^9, 
   3.826871612646331*^9}, {3.82687290109893*^9, 3.826872982331812*^9}, {
   3.8270476149079227`*^9, 3.827047629872755*^9}, {3.827049280624545*^9, 
   3.827049290072159*^9}, {3.827050135294097*^9, 3.8270502201977386`*^9}, {
   3.827050272180252*^9, 3.827050450500847*^9}, {3.827050890948657*^9, 
   3.827050894573043*^9}, {3.827051503378714*^9, 3.827051509476101*^9}, {
   3.827119911632468*^9, 3.827119965843926*^9}, {3.8271203122623997`*^9, 
   3.8271203502645197`*^9}, {3.8275698152642183`*^9, 3.827570002443697*^9}, 
   3.8275701022614107`*^9, {3.827570529087525*^9, 3.827570766764552*^9}, {
   3.827570806145486*^9, 3.827570848997272*^9}, {3.827570884189571*^9, 
   3.827570885141184*^9}, {3.827570920114122*^9, 3.827571032423689*^9}},
 CellLabel->
  "(Debug) In[37]:=",ExpressionUUID->"ca94f182-d985-4023-8e16-1a6aea658d8b"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"MakeMultipoleSegment\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\
\\) is not of the form symbol::name or symbol::name::language.\"",2,37,27,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454675622*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[37]:=",ExpressionUUID->"05df8d90-039d-4e1c-a2fe-35217f4fb929"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Wire object Drawing functions", "Subsubsection",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826871020986096*^9}, 
   3.827087098643194*^9},ExpressionUUID->"5e336881-3802-4f47-bb0a-\
4fb04b2fb366"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"DrawWire\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) produces a 3D graphic of a \
\!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"]\). The \
\!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"]\) must be specified as \
one or more \
\!\(\*StyleBox[\"WireSegment\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\) \
\!\(\*StyleBox[\"WireRectangle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)or\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireCircularArc\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireEllipse\",FontSlant->\"Italic\
\"]\)\!\(\*StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireEllipsoidalArc\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"or\",FontSlant->\"Italic\"]\)\!\(\
\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireSpline\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",\
FontSlant->\"Italic\"]\) objects.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}, {
   3.826870859636942*^9, 3.826870860588332*^9}, 3.826871024239772*^9, 
   3.826871404713279*^9, 3.826871457240347*^9, {3.826871708576836*^9, 
   3.826871743634014*^9}, {3.8268718655488977`*^9, 3.826871868619083*^9}, {
   3.827051558812234*^9, 3.827051630804782*^9}},
 CellLabel->
  "(Debug) In[38]:=",ExpressionUUID->"906f7daa-5a93-4f0d-aedc-85eb61f40e4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Wire object Physics functions", "Subsubsection",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826870991129889*^9}, {
   3.82687102757028*^9, 3.826871033524509*^9}, 
   3.827087100192254*^9},ExpressionUUID->"c2f2bdfe-269b-4702-953d-\
3d5701cffa5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticVectorPotential", "::", "usage"}], "=", 
   "\"\<Watch this spot\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}, {
   3.826870859636942*^9, 3.826870860588332*^9}, 3.826871024239772*^9, {
   3.826871300612267*^9, 3.826871348467098*^9}, 3.826871405823295*^9, 
   3.826871458219298*^9, {3.826871677236389*^9, 3.826871698414998*^9}, {
   3.8270466150472393`*^9, 3.827046640805233*^9}, {3.827047441479722*^9, 
   3.827047489940682*^9}, 3.827047638597453*^9},
 CellLabel->
  "(Debug) In[39]:=",ExpressionUUID->"c0278a5f-0b64-4e62-9b07-f6f79299df36"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInduction", "::", "usage"}], "=", 
   "\"\<\!\(\*StyleBox[\"MagneticInduction\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"{\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\"x\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"y\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"z\",FontSlant->\"\
Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) computes the cartesian \
vector magnetic induction of a \
\!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"]\) at the specified \
\!\(\*StyleBox[\"{\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"x\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"y\"\
,FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"z\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"}\",FontSlant->\"\
Italic\"]\) position. This evaluation point may be symbolic, yielding an en \
expression. The \!\(\*StyleBox[\"wireobject\",FontSlant->\"Italic\"]\) must \
be specified as one or more \
\!\(\*StyleBox[\"WireSegment\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\",\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \
\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"WireCircle\",FontSlant->\"Italic\"\
]\)\!\(\*StyleBox[\"[\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",\
FontSlant->\"Italic\"]\) or \
\!\(\*StyleBox[\"WireRectangle\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"[\",\
FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"]\",FontSlant->\"Italic\"]\) \
objects.\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}, {
   3.826870859636942*^9, 3.826870860588332*^9}, 3.826871024239772*^9, {
   3.826871300612267*^9, 3.826871348467098*^9}, 3.826871405823295*^9, 
   3.826871458219298*^9, {3.826871677236389*^9, 3.826871698414998*^9}, {
   3.8270466150472393`*^9, 3.827046640805233*^9}, {3.827047441479722*^9, 
   3.827047489940682*^9}, {3.827047638597453*^9, 3.827047642076014*^9}},
 CellLabel->
  "(Debug) In[40]:=",ExpressionUUID->"3a9df5fb-dc08-468e-b5bc-0baa24bd1f98"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInductionGradient", "::", "usage"}], "=", 
   "\"\<Watch this spot\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}, {
   3.826870859636942*^9, 3.826870860588332*^9}, 3.826871024239772*^9, {
   3.826871300612267*^9, 3.826871348467098*^9}, 3.826871405823295*^9, 
   3.826871458219298*^9, {3.826871677236389*^9, 3.826871698414998*^9}, {
   3.8270466150472393`*^9, 3.827046640805233*^9}, {3.827047441479722*^9, 
   3.827047489940682*^9}, {3.827047638597453*^9, 3.827047643925167*^9}},
 CellLabel->
  "(Debug) In[41]:=",ExpressionUUID->"7ba05aec-d329-4857-9b65-41d72bedfca3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LorenzForce", "::", "usage"}], "=", "\"\<Watch this spot\>\""}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}, {
   3.826870859636942*^9, 3.826870860588332*^9}, 3.826871024239772*^9, {
   3.826871300612267*^9, 3.826871348467098*^9}, 3.826871405823295*^9, 
   3.826871458219298*^9, {3.826871677236389*^9, 3.826871698414998*^9}, {
   3.8270466150472393`*^9, 3.827046640805233*^9}, {3.827047441479722*^9, 
   3.827047489940682*^9}, {3.827047638597453*^9, 3.827047643925167*^9}},
 CellLabel->
  "(Debug) In[42]:=",ExpressionUUID->"99d24085-dd32-43c4-9c3a-f85864d1094c"],

Cell[BoxData[
 TemplateBox[{
  "Message","name",
   "\"Message name \\!\\(\\*RowBox[{\\\"MessageName\\\", \\\"[\\\", \
RowBox[{\\\"LorenzForce\\\", \\\",\\\", \\\"usage\\\"}], \\\"]\\\"}]\\) is \
not of the form symbol::name or symbol::name::language.\"",2,42,28,
   17084672090476065581,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.827646454848874*^9},
 CellLabel->
  "(Debug) During evaluation of \
In[42]:=",ExpressionUUID->"3e96b379-ebd4-4322-abe8-347df0cdb40f"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Private context", "Section",
 CellChangeTimes->{{3.8268710923072453`*^9, 
  3.826871095377347*^9}},ExpressionUUID->"ae19a15a-52de-4a74-bce5-\
765cc0731219"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529962612115*^9}, {
   3.826529992901599*^9, 3.8265301838639183`*^9}, {3.826609801712772*^9, 
   3.826609820519414*^9}, {3.826616353822967*^9, 3.826616393111788*^9}, {
   3.8266164336287394`*^9, 3.826616489139076*^9}, {3.8266167033548117`*^9, 
   3.826616757270157*^9}, {3.826616791364366*^9, 3.826616866672871*^9}, {
   3.826616922415563*^9, 3.8266171717096577`*^9}, {3.8266186660873013`*^9, 
   3.826618667217287*^9}, {3.8266293499846773`*^9, 3.826629377660041*^9}, {
   3.826629408115252*^9, 3.826629735271565*^9}, {3.8266298080440493`*^9, 
   3.8266298370367517`*^9}, {3.826629879292529*^9, 3.8266301176629877`*^9}, {
   3.826630268587551*^9, 3.826630291980905*^9}, {3.826630335757621*^9, 
   3.82663035142242*^9}, {3.826705572992481*^9, 3.826705673246069*^9}, {
   3.8267079103531103`*^9, 3.8267079107796593`*^9}, {3.8267080455516977`*^9, 
   3.826708097664278*^9}, 3.826708682190696*^9, {3.8268693706950006`*^9, 
   3.8268695806108294`*^9}, {3.826869635963193*^9, 3.826869689253469*^9}, {
   3.826869721346897*^9, 3.826870065402114*^9}, {3.82687010865408*^9, 
   3.826870131682506*^9}, {3.826870191572776*^9, 3.8268701951772614`*^9}, {
   3.826870248396686*^9, 3.826870576166925*^9}, {3.826870607924223*^9, 
   3.8268706294766283`*^9}, {3.826870808357587*^9, 3.8268708282162857`*^9}},
 CellLabel->
  "(Debug) In[43]:=",ExpressionUUID->"5d4dca37-678d-4f9e-ab41-f7fd8e046d10"],

Cell[CellGroupData[{

Cell["Constructors for straight segments", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617760952395*^9}, {
  3.826873022451022*^9, 
  3.826873025757513*^9}},ExpressionUUID->"33bf73fd-6453-4b6b-b791-\
c5fd7b46c640"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireSegment", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireSegment", "[", 
     RowBox[{
      RowBox[{"positions", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
      ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireSegment", "[", 
        RowBox[{"positions", ",", "current", ",", " ", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireSegment", "[", 
      RowBox[{
       RowBox[{"positions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
       ",", "current_", ",", "color_"}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireSegment", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "+", "#"}], ")"}], "&"}], "/@", "positions"}], ",", 
     "current", ",", "color"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617276398245*^9}, {3.8266173690784473`*^9, 
   3.826617526089419*^9}, {3.826617556682274*^9, 3.826617642574113*^9}, {
   3.826617684276061*^9, 3.826617708859189*^9}, {3.826618468147458*^9, 
   3.8266184758645487`*^9}, {3.826870196388558*^9, 3.8268702075155973`*^9}, {
   3.826871459314953*^9, 3.826871467863632*^9}, {3.826871620337212*^9, 
   3.826871625198778*^9}, {3.82687300884939*^9, 3.82687316032738*^9}, {
   3.826874277324254*^9, 3.8268742786469717`*^9}, {3.827083813374271*^9, 
   3.8270838190111427`*^9}, {3.827120164522352*^9, 3.827120165640275*^9}, {
   3.827120202050815*^9, 3.827120298257373*^9}},
 CellLabel->
  "(Debug) In[44]:=",ExpressionUUID->"2425fef0-9479-4375-ba5b-f28dfc0a4cd7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constructors for rectangular current loops", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 
  3.826617760952395*^9}},ExpressionUUID->"3a884ca9-3d6e-43b9-a8da-\
31c2c4098478"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireRectangle", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireRectangle", "[", 
     RowBox[{
      StyleBox["edge_",
       FontSlant->"Italic"], ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireRectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"edge", ",", 
           StyleBox["edge",
            FontSlant->"Italic"], 
           StyleBox[",",
            FontSlant->"Italic"], 
           StyleBox["0",
            FontSlant->"Italic"]}], "}"}], ",", "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireRectangle", "[", 
     RowBox[{
      RowBox[{"position", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      StyleBox["edge_",
       FontSlant->"Italic"], ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireRectangle", "[", 
        RowBox[{"position", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"edge", ",", "edge", ",", "0"}], "}"}], ",", "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireRectangle", "[", 
     RowBox[{
      RowBox[{"position", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"direction", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
      "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireRectangle", "[", 
        RowBox[{"position", ",", 
         RowBox[{"direction", "/", 
          RowBox[{"Norm", "[", "direction", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"xedge", ",", "yedge", ",", "angle"}], "}"}], ",", 
         "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireRectangle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireRectangle", "[", 
      RowBox[{
       RowBox[{"translation", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
       RowBox[{"direction", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
       "current_", ",", "color_"}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireRectangle", "[", 
    RowBox[{
     RowBox[{"translation", "+", "p"}], ",", "direction", ",", 
     RowBox[{"{", 
      RowBox[{"xedge", ",", "yedge", ",", "angle"}], "}"}], ",", "current", 
     ",", "color"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617276398245*^9}, {3.8266173690784473`*^9, 
   3.826617526089419*^9}, {3.826617556682274*^9, 3.826617642574113*^9}, {
   3.826617684276061*^9, 3.826617708859189*^9}, {3.826618468147458*^9, 
   3.8266184758645487`*^9}, {3.826870196388558*^9, 3.8268702075155973`*^9}, {
   3.826871459314953*^9, 3.826871467863632*^9}, {3.826871620337212*^9, 
   3.826871625198778*^9}, {3.82687300884939*^9, 3.826873012599827*^9}, {
   3.826873099282559*^9, 3.826873106544096*^9}, {3.827120410593564*^9, 
   3.8271204114846363`*^9}, {3.827120448403686*^9, 3.827120514244966*^9}},
 CellLabel->
  "(Debug) In[47]:=",ExpressionUUID->"54c4845b-57be-4424-b5df-a1a3005d4802"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for circular current loops", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 
  3.826617751869358*^9}},ExpressionUUID->"89150d40-cf78-43d1-b9de-\
e7d4c938ce64"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireCircle", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircle", "[", 
     RowBox[{"radius_", ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "radius", ",", 
         "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircle", "[", 
     RowBox[{
      RowBox[{"translation", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
      "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireCircle", "[", 
        RowBox[{"translation", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "radius", ",", 
         "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircle", "[", 
     RowBox[{
      RowBox[{"translation", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"direction", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
      "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireCircle", "[", 
        RowBox[{"translation", ",", 
         RowBox[{"direction", "/", 
          RowBox[{"Norm", "[", "direction", "]"}]}], ",", "radius", ",", 
         "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircle", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireCircle", "[", 
      RowBox[{
       RowBox[{"translation", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
       RowBox[{"direction", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
       "current_", ",", "color_"}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireCircle", "[", 
    RowBox[{
     RowBox[{"translation", "+", "p"}], ",", "direction", ",", "radius", ",", 
     "current", ",", "color"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617235170493*^9}, {3.826617293680282*^9, 
   3.826617335068568*^9}, {3.8266177160240192`*^9, 3.826617719240727*^9}, {
   3.826870134468638*^9, 3.826870155508872*^9}, {3.826871407249792*^9, 
   3.826871420694718*^9}, {3.826871614861082*^9, 3.8268716191508617`*^9}, {
   3.8271205372832108`*^9, 3.827120597334852*^9}, {3.8271220586801558`*^9, 
   3.827122088006835*^9}},
 CellLabel->
  "(Debug) In[52]:=",ExpressionUUID->"345d52d2-eee9-4e41-8a02-eb7e0e96e9c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for circular current arcs", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.82704784302562*^9, 
  3.8270478437879133`*^9}},ExpressionUUID->"a2352fb1-f209-43a3-96bd-\
b80145502970"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireCircularArc", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircularArc", "[", 
     RowBox[{"radius_", ",", 
      RowBox[{"{", 
       RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WireCircularArc", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "radius", ",", 
         RowBox[{"{", 
          RowBox[{"theta0", ",", "theta1"}], "}"}], ",", "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}],
            ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircularArc", "[", 
     RowBox[{
      RowBox[{"translation", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
      RowBox[{"{", 
       RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WireCircularArc", "[", 
        RowBox[{"translation", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "radius", ",", 
         RowBox[{"{", 
          RowBox[{"theta0", ",", "theta1"}], "}"}], ",", "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}],
            ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireCircularArc", "[", 
     RowBox[{
      RowBox[{"translation", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"direction", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
      RowBox[{"{", 
       RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WireCircularArc", "[", 
        RowBox[{"translation", ",", 
         RowBox[{"direction", "/", 
          RowBox[{"Norm", "[", "direction", "]"}]}], ",", "radius", ",", 
         RowBox[{"{", 
          RowBox[{"theta0", ",", "theta1"}], "}"}], ",", "current", ",", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireCircularArc", "]"}]}], "]"}]}],
            ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireCircularArc", "[", 
      RowBox[{
       RowBox[{"translation", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
       RowBox[{"direction", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
       RowBox[{"{", 
        RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
       "color_"}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireCircularArc", "[", 
    RowBox[{
     RowBox[{"translation", "+", "p"}], ",", "direction", ",", "radius", ",", 
     
     RowBox[{"{", 
      RowBox[{"theta0", ",", "theta1"}], "}"}], ",", "current", ",", 
     "color"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617235170493*^9}, {3.826617293680282*^9, 
   3.826617335068568*^9}, {3.8266177160240192`*^9, 3.826617719240727*^9}, {
   3.826870134468638*^9, 3.826870155508872*^9}, {3.826871407249792*^9, 
   3.826871420694718*^9}, {3.826871614861082*^9, 3.8268716191508617`*^9}, {
   3.827047962944376*^9, 3.827047974610115*^9}, {3.827048050247271*^9, 
   3.827048080698804*^9}, {3.827048124300234*^9, 3.827048213249358*^9}, {
   3.827048276674037*^9, 3.827048300570135*^9}, {3.827049215090126*^9, 
   3.827049221561466*^9}, {3.827049891816633*^9, 3.8270498935354424`*^9}, {
   3.827120620926203*^9, 3.8271206623532887`*^9}},
 CellLabel->
  "(Debug) In[57]:=",ExpressionUUID->"1fce66ff-f8f4-4db9-90c8-5bcc24e7e4cf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for ellipsoidal current loops", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.8270478879511957`*^9, 
  3.827047892172213*^9}},ExpressionUUID->"80ad9aaf-06b9-4131-bab1-\
46879d32e13b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireEllipse", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617276398245*^9}, {3.8266173690784473`*^9, 
   3.826617526089419*^9}, {3.826617556682274*^9, 3.826617642574113*^9}, {
   3.826617684276061*^9, 3.826617708859189*^9}, {3.826618468147458*^9, 
   3.8266184758645487`*^9}, {3.826870196388558*^9, 3.8268702075155973`*^9}, {
   3.826871459314953*^9, 3.826871467863632*^9}, {3.826871620337212*^9, 
   3.826871625198778*^9}, {3.82687300884939*^9, 3.82687316032738*^9}, {
   3.826874277324254*^9, 3.8268742786469717`*^9}, {3.827050816624113*^9, 
   3.827050869978911*^9}, {3.827058386917622*^9, 3.827058387565482*^9}, {
   3.827083832597003*^9, 3.827083876780176*^9}},
 CellLabel->
  "(Debug) In[62]:=",ExpressionUUID->"ee0626f7-5f24-45a2-b408-07747d889038"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for ellipsoidal current arcs", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.82704784302562*^9, 3.8270478437879133`*^9}, {3.827047875169446*^9, 
  3.827047877929825*^9}},ExpressionUUID->"dba2ad8e-81c4-491b-9062-\
ccac61beccab"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireEllipsoidalArc", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617276398245*^9}, {3.8266173690784473`*^9, 
   3.826617526089419*^9}, {3.826617556682274*^9, 3.826617642574113*^9}, {
   3.826617684276061*^9, 3.826617708859189*^9}, {3.826618468147458*^9, 
   3.8266184758645487`*^9}, {3.826870196388558*^9, 3.8268702075155973`*^9}, {
   3.826871459314953*^9, 3.826871467863632*^9}, {3.826871620337212*^9, 
   3.826871625198778*^9}, {3.82687300884939*^9, 3.82687316032738*^9}, {
   3.826874277324254*^9, 3.8268742786469717`*^9}, {3.827050816624113*^9, 
   3.827050869978911*^9}, {3.827058386917622*^9, 3.827058387565482*^9}, {
   3.827083832597003*^9, 3.8270838859911118`*^9}},
 CellLabel->
  "(Debug) In[63]:=",ExpressionUUID->"e7f85461-1217-4c9c-91ed-8b598575868d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for Bezier spline arcs", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.82704784302562*^9, 3.8270478437879133`*^9}, {3.827047875169446*^9, 
  3.827047907074861*^9}},ExpressionUUID->"046b1a30-3001-440e-af9e-\
197999a53490"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "MakeWireSpline", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireSpline", "[", 
     RowBox[{
      RowBox[{"positions", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
      "current_", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "rules", "}"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "MakeWireSpline", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WireSpline", "[", 
        RowBox[{"positions", ",", "current", ",", " ", 
         RowBox[{"WireColor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"WireColor", "/.", 
            RowBox[{"Join", "[", 
             RowBox[{"rules", ",", 
              RowBox[{"Options", "[", "MakeWireSpline", "]"}]}], "]"}]}], 
           ")"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireSpline", "[", 
      RowBox[{
       RowBox[{"positions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
       "current_", ",", "color_"}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireSpline", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"p", "+", "#"}], ")"}], "&"}], "/@", "positions"}], ",", 
     "current", ",", "color"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, {
   3.826617223811881*^9, 3.826617276398245*^9}, {3.8266173690784473`*^9, 
   3.826617526089419*^9}, {3.826617556682274*^9, 3.826617642574113*^9}, {
   3.826617684276061*^9, 3.826617708859189*^9}, {3.826618468147458*^9, 
   3.8266184758645487`*^9}, {3.826870196388558*^9, 3.8268702075155973`*^9}, {
   3.826871459314953*^9, 3.826871467863632*^9}, {3.826871620337212*^9, 
   3.826871625198778*^9}, {3.82687300884939*^9, 3.82687316032738*^9}, {
   3.826874277324254*^9, 3.8268742786469717`*^9}, {3.827050816624113*^9, 
   3.827050869978911*^9}, {3.827058386917622*^9, 3.827058387565482*^9}, {
   3.827083832597003*^9, 3.8270838633077803`*^9}, {3.8271206875981207`*^9, 
   3.827120730801944*^9}},
 CellLabel->
  "(Debug) In[64]:=",ExpressionUUID->"994984dd-86a5-4879-865d-e5c344fa1ba6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for grouped and repeated objects", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.82704784302562*^9, 3.8270478437879133`*^9}, {3.827047875169446*^9, 
  3.827047907074861*^9}, {3.827118264828491*^9, 3.8271182687896967`*^9}, {
  3.8271186476081657`*^9, 
  3.827118649490889*^9}},ExpressionUUID->"6442e5d9-7b2e-4685-8dad-\
248668214ff6"],

Cell["\<\
We will save considerable computation time by allowing functionality for a \
repeated object. It will then only be built once, and used repeatedly.\
\>", "Text",
 CellChangeTimes->{{3.827118277692834*^9, 3.827118333627265*^9}, {
  3.827119998837472*^9, 
  3.8271199994780483`*^9}},ExpressionUUID->"d76ab578-b677-45a8-a20a-\
b305215d1b22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireGroup", "[", 
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}], ".."}], "}"}]}], "]"}], ":=", 
    RowBox[{"WireGroup", "[", "g", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireGroup", "[", 
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
           "_WireCircularArc", "|", "_WireEllipse", "|", 
           "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
           "|", "_WireGroup"}], ")"}], ".."}], "}"}]}], "]"}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireGroup", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"TranslateWire", "[", 
       RowBox[{"#", ",", "p"}], "]"}], "&"}], "/@", "g"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052170553142*^9}, {
   3.827118366226454*^9, 3.82711838214367*^9}, {3.827118420813787*^9, 
   3.827118623595242*^9}, {3.827119039114362*^9, 3.827119264328315*^9}, 
   3.827119935400597*^9, {3.827120125033835*^9, 3.827120139536113*^9}, {
   3.8271207634857073`*^9, 3.827120768334957*^9}, {3.827120808155272*^9, 
   3.827120840917878*^9}, 3.8271208748632793`*^9, {3.82712103253686*^9, 
   3.827121065628027*^9}},
 CellLabel->
  "(Debug) In[67]:=",ExpressionUUID->"2e4590b4-b455-4522-81d7-1b18c6586653"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeWireRepeated", "[", 
     RowBox[{
      RowBox[{"o", ":", 
       RowBox[{"(", 
        RowBox[{
        "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
         "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc", 
         "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
        ")"}]}], ",", 
      RowBox[{"offset", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], "]"}], 
    ":=", "\[IndentingNewLine]", 
    RowBox[{"WireRepeated", "[", 
     RowBox[{"o", ",", "offset", ",", "nRepeat"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TranslateWire", "[", 
    RowBox[{
     RowBox[{"WireRepeated", "[", 
      RowBox[{
       RowBox[{"o", ":", 
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}]}], ",", 
       RowBox[{"offset", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], "]"}],
      ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"WireRepeated", "[", 
    RowBox[{
     RowBox[{"TranslateWire", "[", 
      RowBox[{"o", ",", "p"}], "]"}], ",", "offset", ",", "nRepeat"}], 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052170553142*^9}, {
   3.827118366226454*^9, 3.82711838214367*^9}, {3.827118420813787*^9, 
   3.827118623595242*^9}, {3.827119039114362*^9, 3.827119264328315*^9}, 
   3.827119935400597*^9, {3.827120848512134*^9, 3.8271208898475647`*^9}, {
   3.827120952548922*^9, 3.827121005384137*^9}},
 CellLabel->
  "(Debug) In[69]:=",ExpressionUUID->"69feb243-5dfe-402c-aeb5-ce224f7de301"]
}, Closed]],

Cell[CellGroupData[{

Cell["Constructors for multipole objects", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617751869358*^9}, {
  3.82704784302562*^9, 3.8270478437879133`*^9}, {3.827047875169446*^9, 
  3.827047907074861*^9}, {3.827118264828491*^9, 3.8271182687896967`*^9}, {
  3.8271186476081657`*^9, 3.827118649490889*^9}, {3.8275710793077803`*^9, 
  3.8275710810597963`*^9}},ExpressionUUID->"5768c730-3ea7-4b20-911d-\
686cd7d1f5c9"],

Cell["\<\
We pre-integrate the multipole expansion terms, using the very convenient \
Interpolation object of Mathematica. Each function has only one remaining \
argument, namely the angle of the evaluation point w.r.t. the x-y plane, with \
origin at the centre of gravity point.\
\>", "Text",
 CellChangeTimes->{{3.827577211720306*^9, 3.827577241659137*^9}, {
  3.827577273553141*^9, 
  3.8275773616997967`*^9}},ExpressionUUID->"5d9b22dd-2e7a-4e39-9849-\
80ee5d1cb6d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeMultipoleSegment", "[", 
     RowBox[{
      RowBox[{"ws", ":", 
       RowBox[{"WireSegment", "[", 
        RowBox[{
         RowBox[{"positions", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"left", ":", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
            RowBox[{"right", ":", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "}"}]}], ",", 
         "current_", ",", "color_"}], "]"}]}], ",", "field_String"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cg", ",", "rDash", ",", "lWire", ",", 
        RowBox[{"n", "=", "20"}], ",", "VectorPotentialLineIntegration"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rDash", "[", "s_", "]"}], ":=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "s"}], ")"}], " ", "left"}], "+", 
           RowBox[{"s", " ", "right"}]}], ")"}], "-", "cg"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Interpolate", " ", "the", " ", "position", " ", "on", " ", "the", 
         " ", "line"}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"VectorPotentialLineIntegration", "[", "]"}], ":=", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"FunctionInterpolation", "[", 
           RowBox[{
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"s", " ", "lWire"}], ")"}], "#"], 
               RowBox[{"LegendreP", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]", ",", "0", ",", 
              RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}], "&"}], "/@", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", 
           RowBox[{"n", "-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Chop", "[", 
             RowBox[{"FunctionInterpolation", "[", 
              RowBox[{
               RowBox[{"NIntegrate", "[", 
                RowBox[{
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"rDash", "[", "s", "]"}], ".", 
                    RowBox[{"rDash", "[", "s", "]"}]}]], ")"}], "#"], 
                  RowBox[{"LegendreP", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"s", ",", "0", ",", "1"}], "}"}], ",", 
                 RowBox[{"MaxRecursion", "\[Rule]", "2"}], ",", 
                 RowBox[{"Method", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{"\"\<LobattoKronrodRule\>\"", ",", 
                    RowBox[{
                    "\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
                   "}"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Phi]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}], 
             "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", 
             RowBox[{"n", "-", "1"}]}], "]"}]}], ";", " ", 
          RowBox[{"For", " ", "evaluation"}]}], ",", " ", 
         RowBox[{
         "we", " ", "need", " ", "to", " ", "consider", " ", "the", " ", 
          "projection", " ", "allowing", " ", "the", " ", 
          RowBox[{"cone", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"field", "\[Equal]", "\"\<VectorPotential\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cg", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"left", "+", "right"}], ")"}], "/", "2"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lWire", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"right", "-", "left"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"right", "-", "left"}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"MultipoleSegment", "[", 
           RowBox[{
            RowBox[{"VectorPotentialMultipole", "[", 
             RowBox[{"cg", ",", "lWire", ",", 
              RowBox[{"5", " ", "lWire"}], ",", 
              RowBox[{"VectorPotentialLineIntegration", "[", "]"}]}], "]"}], 
            ",", "ws"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MakeMultipoleSegment", "[", 
      RowBox[{
       RowBox[{"ws", ":", 
        RowBox[{"WireSegment", "[", 
         RowBox[{
          RowBox[{"positions", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", ".."}], "}"}]}], 
          ",", "current_", ",", "color_"}], "]"}]}], ",", "field_String"}], 
      "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"MakeMultipoleSegment", "[", 
        RowBox[{
         RowBox[{"WireSegment", "[", 
          RowBox[{"#", ",", "current", ",", "color"}], "]"}], ",", "field"}], 
        "]"}], "&"}], "/@", 
      RowBox[{"Partition", "[", 
       RowBox[{"positions", ",", "2", ",", "1"}], "]"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827571146757031*^9, 3.827571292658168*^9}, {
   3.827571338678846*^9, 3.82757136050764*^9}, {3.827571392095245*^9, 
   3.82757140234545*^9}, {3.8275741219655046`*^9, 3.827574162253524*^9}, 
   3.827574196316823*^9, {3.827574233122555*^9, 3.8275743128518267`*^9}, {
   3.827574365046706*^9, 3.827574384886071*^9}, {3.827574559108386*^9, 
   3.8275745632374353`*^9}, {3.827574626753375*^9, 3.827574688704027*^9}, {
   3.827574857358408*^9, 3.8275750548816767`*^9}, 3.827575280880457*^9, {
   3.8275753157488117`*^9, 3.827575355271391*^9}, {3.827575438884985*^9, 
   3.827575558536439*^9}, {3.8275756120785017`*^9, 3.827575664908745*^9}, {
   3.827575754056391*^9, 3.827575820175211*^9}, {3.827575864867469*^9, 
   3.8275758733487062`*^9}, {3.827575906544273*^9, 3.827575911415551*^9}, {
   3.8275759526459618`*^9, 3.827575953069324*^9}, {3.82757604268224*^9, 
   3.827576045936038*^9}, 3.827576089047007*^9, 3.827576269662472*^9, 
   3.8275763100903788`*^9, {3.827576394503584*^9, 3.8275763980882597`*^9}, {
   3.827576699444544*^9, 3.8275767224623737`*^9}, 3.827576808895859*^9, {
   3.827577052124683*^9, 3.827577061213451*^9}, {3.827577162096664*^9, 
   3.827577167143428*^9}, {3.827577442257638*^9, 3.827577446514625*^9}, 
   3.8275775283206453`*^9, 3.8275777876733217`*^9, {3.827577884949751*^9, 
   3.8275779605950603`*^9}, 3.827577998225748*^9, {3.827579479664579*^9, 
   3.8275796662065687`*^9}, {3.8275797536203537`*^9, 3.827579932994255*^9}, {
   3.8275802506514597`*^9, 3.827580256747573*^9}, {3.827580491369647*^9, 
   3.827580491487623*^9}, {3.827634191816498*^9, 3.82763437087782*^9}, {
   3.8276344311302347`*^9, 3.8276344899134693`*^9}, {3.827634520674615*^9, 
   3.827634577111794*^9}, {3.827634612672983*^9, 3.827634616863057*^9}, {
   3.827634670045875*^9, 3.827634673717053*^9}, {3.827634994355296*^9, 
   3.827635005634152*^9}, 3.827635039430937*^9, {3.827635306262257*^9, 
   3.827635307804179*^9}, {3.8276353574192333`*^9, 3.827635358182263*^9}, {
   3.827635564779471*^9, 3.827635583955387*^9}, {3.827635621901394*^9, 
   3.8276356807625303`*^9}, {3.8276357219978123`*^9, 3.827635737545043*^9}, 
   3.8276358171986732`*^9, {3.827636344651928*^9, 3.827636397653215*^9}, 
   3.827636592683956*^9, {3.8276369421153173`*^9, 3.827636944744659*^9}, {
   3.827637458663455*^9, 3.827637477754318*^9}, {3.827637635403131*^9, 
   3.827637638435134*^9}, {3.827637705044043*^9, 3.827637707483632*^9}, {
   3.827637795395705*^9, 3.827637796981408*^9}, {3.827637884254328*^9, 
   3.827637964853382*^9}, {3.827638008979308*^9, 3.8276380110719213`*^9}, {
   3.8276383662263317`*^9, 3.827638387059491*^9}, {3.82763845804038*^9, 
   3.827638472534608*^9}, {3.827638628790159*^9, 3.8276386766438503`*^9}, {
   3.8276394117294292`*^9, 3.827639452146007*^9}, {3.827639598840271*^9, 
   3.827639635163542*^9}, {3.827639723770632*^9, 3.827639727098033*^9}, {
   3.827639966445961*^9, 3.8276400274899673`*^9}, {3.827640363082876*^9, 
   3.8276404210171328`*^9}, {3.827640457040801*^9, 3.827640512188057*^9}, {
   3.8276405540026503`*^9, 3.8276405561922417`*^9}, {3.827640617401483*^9, 
   3.8276406695298557`*^9}, {3.827640747604135*^9, 3.8276408082168913`*^9}, {
   3.827640947124556*^9, 3.8276409518328667`*^9}, {3.8276410737314873`*^9, 
   3.827641086019041*^9}, {3.827641217145994*^9, 3.827641256400847*^9}, {
   3.82764128997421*^9, 3.827641370262637*^9}, {3.827641497424415*^9, 
   3.8276414978744373`*^9}, {3.827642102164626*^9, 3.82764213167572*^9}, {
   3.82764216795636*^9, 3.8276421724803953`*^9}, {3.827642424823964*^9, 
   3.827642455621421*^9}, {3.8276425529154987`*^9, 3.8276425673710833`*^9}, {
   3.827642633589821*^9, 3.8276426338878613`*^9}, {3.8276427831395063`*^9, 
   3.82764292176075*^9}, {3.827642965737404*^9, 3.827643007754949*^9}, {
   3.827643043236537*^9, 3.827643054655414*^9}, {3.827643104937714*^9, 
   3.8276431067495604`*^9}, {3.827644079035122*^9, 3.827644084361681*^9}, 
   3.82764441840315*^9, 3.8276591829666843`*^9, {3.827659332732437*^9, 
   3.82765934882965*^9}, {3.827659722602831*^9, 3.827659722776307*^9}, 
   3.827660048247819*^9, {3.827660441145294*^9, 3.827660516759368*^9}, 
   3.8276605914328947`*^9, {3.827660656893215*^9, 3.827660735709834*^9}, {
   3.827661422051136*^9, 3.827661422230091*^9}, {3.8276625023166933`*^9, 
   3.8276625083827467`*^9}, {3.827662603719592*^9, 3.827662607421612*^9}, {
   3.827730956209613*^9, 
   3.827730969560762*^9}},ExpressionUUID->"8cc1f17c-75af-4abc-99a2-\
232ea99e922e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeMultipoleSegment", "[", 
    RowBox[{
     RowBox[{"ws", ":", 
      RowBox[{"WireRectangle", "[", 
       RowBox[{
        RowBox[{"translation", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"direction", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
        "current_", ",", "color_"}], "]"}]}], ",", "field_String"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827571146757031*^9, 3.827571292658168*^9}, {
   3.827571338678846*^9, 3.82757136050764*^9}, {3.827571392095245*^9, 
   3.827571404191413*^9}, 3.827576212128518*^9},
 CellLabel->
  "(Debug) In[72]:=",ExpressionUUID->"5068acfa-9ad0-415a-b67d-8fa0164709d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeMultipoleSegment", "[", 
     RowBox[{
      RowBox[{"ws", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"translation", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}], ",", "field_String"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeMultipoleSegment", "[", 
    RowBox[{
     RowBox[{"ws", ":", 
      RowBox[{"WireCircularArc", "[", 
       RowBox[{
        RowBox[{"translation", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"direction", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
        RowBox[{"{", 
         RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
        "color_"}], "]"}]}], ",", "field_String"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827571146757031*^9, 3.827571292658168*^9}, {
  3.827571338678846*^9, 3.82757136050764*^9}, {3.827571392095245*^9, 
  3.827571496085649*^9}, {3.8275762133802547`*^9, 3.8275762150440893`*^9}},
 CellLabel->
  "(Debug) In[73]:=",ExpressionUUID->"24e050c4-37fd-4b83-bd92-48488f0c32da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MakeMultipoleSegment", "[", 
     RowBox[{
      RowBox[{"ws", ":", 
       RowBox[{"WireSpline", "[", 
        RowBox[{
         RowBox[{"positions", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
         "current_", ",", "color_"}], "]"}]}], ",", "field_String"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakeMultipoleSegment", "[", 
    RowBox[{
     RowBox[{"ws", ":", 
      RowBox[{"WireGroup", "[", 
       RowBox[{"g", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
           "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
            "_WireCircularArc", "|", "_WireEllipse", "|", 
            "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
            "|", "_WireGroup"}], ")"}], ".."}], "}"}]}], "]"}]}], ",", 
     "field_String"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827571146757031*^9, 3.827571292658168*^9}, {
  3.827571338678846*^9, 3.82757136050764*^9}, {3.827571392095245*^9, 
  3.8275715130901327`*^9}, {3.8275715506895113`*^9, 3.827571587749771*^9}, {
  3.827576219078024*^9, 3.827576220880167*^9}},
 CellLabel->
  "(Debug) In[75]:=",ExpressionUUID->"d533c991-72df-400e-a49c-f984f245aaca"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeMultipoleSegment", "[", 
    RowBox[{
     RowBox[{"ws", ":", 
      RowBox[{"WireRepeated", "[", 
       RowBox[{
        RowBox[{"o", ":", 
         RowBox[{"(", 
          RowBox[{
          "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
           "_WireCircularArc", "|", "_WireEllipse", "|", 
           "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
           "|", "_WireGroup"}], ")"}]}], ",", 
        RowBox[{"offset", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], 
       "]"}]}], ",", "field_String"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827571146757031*^9, 3.827571292658168*^9}, {
   3.827571338678846*^9, 3.82757136050764*^9}, {3.827571392095245*^9, 
   3.8275715130901327`*^9}, {3.8275715506895113`*^9, 3.827571589673924*^9}, 
   3.827576223217836*^9},
 CellLabel->
  "(Debug) In[77]:=",ExpressionUUID->"eacf6f55-8783-4ee6-9eb4-df1b71e4325c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wire object Drawing functions", "Subsection",
 CellChangeTimes->{{3.826617740913156*^9, 3.826617784766219*^9}, 
   3.826871283638748*^9, 
   3.827087122731782*^9},ExpressionUUID->"8e7dbc06-969b-45af-b141-\
d315396cda22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "DrawWire", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"WireColor", "\[Rule]", "Red"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{
     RowBox[{"l", ":", 
      RowBox[{"{", "__", "}"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"DrawWire", "[", 
      RowBox[{"#", ",", "opts"}], "]"}], "&"}], "/@", "l"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052170553142*^9}},
 CellLabel->
  "(Debug) In[78]:=",ExpressionUUID->"8dfb6ed4-8eae-453f-ba04-c9f3cdeb45d8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{
     RowBox[{"l", ":", 
      RowBox[{"WireSegment", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
        ",", "current_", ",", "color_"}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", " ", 
         RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "current", "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"WireColor", "/.", 
           RowBox[{"Join", "[", 
            RowBox[{"rules", ",", 
             RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"Reverse", "[", "positions", "]"}], "]"}], "]"}]}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"WireColor", "/.", 
           RowBox[{"Join", "[", 
            RowBox[{"rules", ",", 
             RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", "positions", "]"}], "]"}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052170553142*^9}},
 CellLabel->
  "(Debug) In[80]:=",ExpressionUUID->"53f18218-f44a-4ea2-ae3a-e24df118b7ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{
     RowBox[{"l", ":", 
      RowBox[{"WireRectangle", "[", 
       RowBox[{
        RowBox[{"translation", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"direction", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
        "current_", ",", "color_"}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coordinates", ",", "rules"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", " ", 
         RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coordinates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"angle", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", "#"}], 
          ")"}], "&"}], "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["xedge", "2"]}], ",", 
            RowBox[{"-", 
             FractionBox["yedge", "2"]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["xedge", "2"], ",", 
            RowBox[{"-", 
             FractionBox["yedge", "2"]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["xedge", "2"], ",", 
            FractionBox["yedge", "2"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["xedge", "2"]}], ",", 
            FractionBox["yedge", "2"], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["xedge", "2"]}], ",", 
            RowBox[{"-", 
             FractionBox["yedge", "2"]}], ",", "0"}], "}"}]}], "}"}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "current", "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"coordinates", "=", 
         RowBox[{"Reverse", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"RotationMatrix", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  "direction"}], "}"}], "]"}], ".", "#"}], "+", 
              "translation"}], ")"}], "&"}], "/@", "coordinates"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"coordinates", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationMatrix", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                 "direction"}], "}"}], "]"}], ".", "#"}], "+", 
             "translation"}], ")"}], "&"}], "/@", "coordinates"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WireColor", "/.", 
         RowBox[{"Join", "[", 
          RowBox[{"rules", ",", 
           RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
        RowBox[{"Arrow", "[", 
         RowBox[{
          RowBox[{"Tube", "[", 
           RowBox[{"coordinates", ",", 
            RowBox[{"xedge", " ", "0.01"}]}], "]"}], ",", 
          RowBox[{"xedge", " ", "0.05"}]}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.82705216776497*^9}},
 CellLabel->
  "(Debug) In[81]:=",ExpressionUUID->"a8234be0-8ac7-4a12-b65c-1d4c66ec81f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawWire", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"translation", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coordinates", ",", "rules", ",", "backbone"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"backbone", "=", 
        RowBox[{"splineCircle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "radius", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"backbone", "=", 
        RowBox[{"BSplineCurve", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "direction"}], "}"}], "]"}], ".", "#"}], ")"}], "+", 
                "translation"}], ")"}], "&"}], "/@", 
             RowBox[{"First", "[", 
              RowBox[{"List", "@@", "backbone"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Rest", "[", 
            RowBox[{"List", "@@", "backbone"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"WireColor", "/.", 
          RowBox[{"Join", "[", 
           RowBox[{"rules", ",", 
            RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"backbone", ",", 
           RowBox[{"radius", " ", "0.05"}]}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DrawWire", "[", 
     RowBox[{
      RowBox[{"l", ":", 
       RowBox[{"WireCircularArc", "[", 
        RowBox[{
         RowBox[{"translation", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         RowBox[{"{", 
          RowBox[{"theta0_", ",", "theta1_"}], "}"}], ",", "current_", ",", 
         "color_"}], "]"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coordinates", ",", "rules", ",", "backbone"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rules", "=", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", " ", 
          RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"backbone", "=", 
        RowBox[{"splineCircle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "radius", ",", 
          RowBox[{"{", 
           RowBox[{"theta0", ",", "theta1"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"backbone", "=", 
        RowBox[{"BSplineCurve", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"RotationMatrix", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "direction"}], "}"}], "]"}], ".", "#"}], ")"}], "+", 
                "translation"}], ")"}], "&"}], "/@", 
             RowBox[{"First", "[", 
              RowBox[{"List", "@@", "backbone"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Rest", "[", 
            RowBox[{"List", "@@", "backbone"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"WireColor", "/.", 
          RowBox[{"Join", "[", 
           RowBox[{"rules", ",", 
            RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
         RowBox[{"Arrow", "[", 
          RowBox[{"backbone", ",", 
           RowBox[{"radius", " ", "0.05"}]}], "]"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"splineCircle", "[", 
   RowBox[{"m_List", ",", "r_", ",", 
    RowBox[{"angles_List:", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "seg", ",", "\[Phi]", ",", "start", ",", "end", ",", "pts", ",", "w", 
       ",", "k"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"start", ",", "end"}], "}"}], "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{"angles", "//", "N"}], ",", 
         RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"end", "\[LessEqual]", "start"}], ",", 
        RowBox[{"end", "+=", 
         RowBox[{"2", " ", "\[Pi]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"seg", "=", 
       RowBox[{"Quotient", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"end", "-", "start"}], "//", "N"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"end", "-", "start"}], "//", "N"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"seg", "\[Equal]", "4"}], ",", 
        RowBox[{
         RowBox[{"seg", "=", "3"}], ";", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{"\[Pi]", "/", "2"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pts", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"r", " ", 
          RowBox[{
           RowBox[{"RotationMatrix", "[", "start", "]"}], ".", "#"}]}], "&"}],
         "/@", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"RotationMatrix", "[", 
              RowBox[{"seg", " ", 
               RowBox[{"\[Pi]", "/", "2"}]}], "]"}], ".", "#"}], "&"}], "/@", 
           
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Tan", "[", 
                RowBox[{"\[Phi]", "/", "2"}], "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
               RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "}"}]}], "}"}]}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], ",", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "+", "#"}], "&"}], "/@", "pts"}]}], ",", 
        RowBox[{"pts", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "+", "#"}], "&"}], "/@", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "pts", "]"}], ",", 
             RowBox[{"ConstantArray", "[", 
              RowBox[{"0", ",", 
               RowBox[{"Length", "[", "pts", "]"}]}], "]"}]}], "]"}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1", ",", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "1"}], "}"}], ",", 
           RowBox[{
            RowBox[{"2", " ", "seg"}], "+", "1"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]", "/", "2"}], "]"}], ",", "1"}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{"#", ",", "#"}], "]"}], "&"}], "@", 
          RowBox[{"Range", "[", 
           RowBox[{"seg", "+", "1"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"seg", "+", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"BSplineCurve", "[", 
       RowBox[{"pts", ",", 
        RowBox[{"SplineDegree", "\[Rule]", "2"}], ",", 
        RowBox[{"SplineKnots", "\[Rule]", "k"}], ",", 
        RowBox[{"SplineWeights", "\[Rule]", "w"}]}], "]"}]}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "2"}], "||", 
    RowBox[{
     RowBox[{"Length", "[", "m", "]"}], "\[Equal]", "3"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052165253211*^9}, {
   3.827146039916233*^9, 3.8271460462868013`*^9}, {3.827146084032894*^9, 
   3.82714611336909*^9}, 3.827146143904213*^9, {3.827146195475363*^9, 
   3.8271462481116953`*^9}, 3.8271463105827847`*^9, {3.8271463591372223`*^9, 
   3.827146445010253*^9}, {3.8271465139156113`*^9, 3.827146609846794*^9}, 
   3.82714668677131*^9, {3.827146792029274*^9, 3.827146801699592*^9}, {
   3.827146907776745*^9, 3.827146911437965*^9}, {3.827146965096305*^9, 
   3.8271469950456047`*^9}, {3.827147107612031*^9, 3.8271471191939*^9}, {
   3.827147183500169*^9, 3.8271471849750633`*^9}, {3.8272319813963327`*^9, 
   3.827232001274715*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "(Debug) In[82]:=",ExpressionUUID->"340d345e-54ba-43ae-aefc-88cb6c137555"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{
     RowBox[{"l", ":", 
      RowBox[{"WireSpline", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "rules", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rules", "=", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "opts", "}"}], ",", " ", 
         RowBox[{"Options", "[", "DrawWire", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "current", "]"}], "\[Equal]", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"WireColor", "/.", 
           RowBox[{"Join", "[", 
            RowBox[{"rules", ",", 
             RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"BezierCurve", "[", 
             RowBox[{"Reverse", "[", "positions", "]"}], "]"}], "]"}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"WireColor", "/.", 
           RowBox[{"Join", "[", 
            RowBox[{"rules", ",", 
             RowBox[{"{", "color", "}"}]}], "]"}]}], ",", 
          RowBox[{"Arrow", "[", 
           RowBox[{"Tube", "[", 
            RowBox[{"BezierCurve", "[", "positions", "]"}], "]"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052199887146*^9}, {
   3.82705812091444*^9, 3.827058149694889*^9}, {3.8270582028988028`*^9, 
   3.8270582306363583`*^9}, {3.8271193179924307`*^9, 3.827119321607935*^9}},
 CellLabel->
  "(Debug) In[84]:=",ExpressionUUID->"fff88d41-3ff6-4aba-9b23-54689b7f600e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{"WireRepeated", "[", 
     RowBox[{
      RowBox[{"o", ":", 
       RowBox[{"(", 
        RowBox[{
        "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
         "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc", 
         "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
        ")"}]}], ",", 
      RowBox[{"offset", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], "]"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DrawWire", "[", 
      RowBox[{"TranslateWire", "[", 
       RowBox[{"o", ",", 
        RowBox[{"offset", " ", "#"}]}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", 
      RowBox[{"(", 
       RowBox[{"nRepeat", "-", "1"}], ")"}]}], "]"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052199887146*^9}, {
   3.82705812091444*^9, 3.827058149694889*^9}, {3.8270582028988028`*^9, 
   3.8270582306363583`*^9}, {3.8271193179924307`*^9, 
   3.8271194121150627`*^9}, {3.8271196356923943`*^9, 3.827119852715253*^9}, 
   3.827121172379459*^9, 3.827121311185614*^9},
 CellLabel->
  "(Debug) In[85]:=",ExpressionUUID->"55f86390-1f49-4117-95d7-a58df0670a07"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", 
    RowBox[{"WireGroup", "[", 
     RowBox[{"g", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}], ".."}], "}"}]}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"DrawWire", "[", "#", "]"}], "&"}], "/@", "g"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052199887146*^9}, {
   3.82705812091444*^9, 3.827058149694889*^9}, {3.8270582028988028`*^9, 
   3.8270582306363583`*^9}, {3.8271193179924307`*^9, 
   3.8271194121150627`*^9}, {3.8271196356923943`*^9, 
   3.8271198447720547`*^9}, {3.827571653301133*^9, 3.827571674009178*^9}},
 CellLabel->
  "(Debug) In[86]:=",ExpressionUUID->"b007a946-1abd-45e8-a016-1b8f2ad3731c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DrawWire", "[", "\[IndentingNewLine]", 
    RowBox[{"MultipoleSegment", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "_VectorPotentialMultipole", "|", "_MagneticInductionMultipole", "|",
           "_MagneticInductionGradientMultipole"}], ")"}], ".."}], "}"}], ",",
       " ", 
      RowBox[{"w", ":", 
       RowBox[{"(", 
        RowBox[{
        "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
         "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc", 
         "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
        ")"}]}]}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"DrawWire", "[", "w", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82651891267078*^9, 3.826519140713434*^9}, {
   3.826519188671207*^9, 3.8265193867894573`*^9}, {3.826519428753152*^9, 
   3.826519656114292*^9}, {3.826519690528233*^9, 3.826519710760147*^9}, {
   3.826519749619862*^9, 3.826519875572771*^9}, {3.826519907247065*^9, 
   3.826519974287359*^9}, {3.826520047588726*^9, 3.8265202755013943`*^9}, {
   3.8265203809004507`*^9, 3.8265204169013042`*^9}, {3.8265204507247562`*^9, 
   3.826520501381135*^9}, {3.826520555485323*^9, 3.826520590935421*^9}, {
   3.8265206354241753`*^9, 3.826520653150715*^9}, {3.826520712260395*^9, 
   3.826520721030959*^9}, {3.8265207693482513`*^9, 3.826520783187664*^9}, {
   3.826520824331544*^9, 3.8265208613431063`*^9}, {3.826520919653722*^9, 
   3.8265209999026737`*^9}, {3.826521042833785*^9, 3.82652105628605*^9}, {
   3.826521236728013*^9, 3.82652126759441*^9}, {3.826521298144129*^9, 
   3.826521314791519*^9}, {3.82652141225492*^9, 3.8265214692334623`*^9}, {
   3.826521511683607*^9, 3.8265215377733917`*^9}, {3.826521604772997*^9, 
   3.826521618212154*^9}, {3.826521669792512*^9, 3.826521691948051*^9}, {
   3.826521724247986*^9, 3.826521755146193*^9}, {3.826521790077262*^9, 
   3.826521952205542*^9}, {3.826522191376154*^9, 3.826522210653611*^9}, 
   3.826522261738442*^9, {3.826522342340494*^9, 3.826522438302689*^9}, {
   3.826522474011559*^9, 3.826522477719051*^9}, 3.826522533503181*^9, {
   3.8265225662824507`*^9, 3.8265225736574*^9}, {3.8265227264632*^9, 
   3.826522735100095*^9}, {3.826522878924676*^9, 3.826522914012189*^9}, {
   3.826525755784487*^9, 3.826525756169272*^9}, {3.826525843753644*^9, 
   3.8265259001664267`*^9}, {3.826529838243443*^9, 3.826529862159914*^9}, {
   3.8266098235573072`*^9, 3.8266098544695883`*^9}, {3.826616589249062*^9, 
   3.826616616935667*^9}, {3.826616658111803*^9, 3.826616674291306*^9}, 
   3.826617223811881*^9, {3.826617711629376*^9, 3.826617712919133*^9}, {
   3.826617842372395*^9, 3.8266178644624567`*^9}, {3.826617905643709*^9, 
   3.8266180032581367`*^9}, {3.8266180682607822`*^9, 
   3.8266180927214823`*^9}, {3.826618153044341*^9, 3.826618219623287*^9}, {
   3.826618250189992*^9, 3.8266183550249777`*^9}, {3.826618570957466*^9, 
   3.826618572281879*^9}, 3.826870158021524*^9, 3.826870208802833*^9, 
   3.8268714218388443`*^9, 3.826871468719652*^9, {3.8268716261211863`*^9, 
   3.826871627901031*^9}, {3.826871913099218*^9, 3.826871927707438*^9}, {
   3.826872051383586*^9, 3.8268720545524178`*^9}, {3.826873300410056*^9, 
   3.826873407020046*^9}, {3.8268735045704393`*^9, 3.826873590705987*^9}, {
   3.8268742525730553`*^9, 3.8268742532437696`*^9}, {3.8268744079991493`*^9, 
   3.826874417770914*^9}, {3.827047722238204*^9, 3.82704774139498*^9}, {
   3.827048336724184*^9, 3.8270483660735607`*^9}, {3.8270483992394876`*^9, 
   3.8270484816316233`*^9}, {3.82704852128325*^9, 3.827048614967749*^9}, {
   3.827048647632371*^9, 3.8270487333238783`*^9}, {3.827048765466434*^9, 
   3.827048786856372*^9}, {3.827048821053269*^9, 3.827048851567953*^9}, {
   3.827048981692122*^9, 3.827048984080737*^9}, {3.827049695055538*^9, 
   3.827049696206644*^9}, {3.827052163288863*^9, 3.827052199887146*^9}, {
   3.82705812091444*^9, 3.827058149694889*^9}, {3.8270582028988028`*^9, 
   3.8270582306363583`*^9}, {3.8271193179924307`*^9, 
   3.8271194121150627`*^9}, {3.8271196356923943`*^9, 
   3.8271198447720547`*^9}, {3.827571653301133*^9, 3.827571674009178*^9}, {
   3.82757172056324*^9, 3.827571849025578*^9}, {3.827571889325268*^9, 
   3.827571941207348*^9}, {3.827572021072061*^9, 3.827572046240202*^9}, {
   3.8275721294597178`*^9, 3.827572143848587*^9}},
 CellLabel->
  "(Debug) In[87]:=",ExpressionUUID->"3737c94d-661e-403c-8bea-41e0745ce82b"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wire object Physics functions", "Section",
 CellChangeTimes->{{3.8268709874730873`*^9, 3.826870991129889*^9}, {
   3.82687102757028*^9, 3.826871033524509*^9}, 
   3.827087100192254*^9},ExpressionUUID->"27e8894e-7e63-453c-b01b-\
88dd90e6649c"],

Cell[CellGroupData[{

Cell["\<\
WireSegment: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 
  3.8270471186579447`*^9}},ExpressionUUID->"27155e7b-44db-4209-bbd3-\
c49661ddf021"],

Cell["\<\
For a straight wire segment, we will rotate the axes to place the line along \
the z axis, with the first coordinate at the origin. Some terms are then \
automatically zero.

We only require to know the distance from the wire when within the Voronoi \
box of the wire, and of course the distance from the wire ends when outside \
of the Voronoi box. \
\>", "Text",
 CellChangeTimes->{{3.8270300006981916`*^9, 3.827030099416883*^9}, {
  3.827035464715457*^9, 3.827035554639226*^9}, {3.8270470162495337`*^9, 
  3.827047045003393*^9}},ExpressionUUID->"3bbe6e78-2883-4c1a-a67e-\
356f4a4b98d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireSegment", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
        ",", "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LineSegment", ",", "t", ",", "s"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LineSegment", "[", 
         RowBox[{
          RowBox[{"start", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
          RowBox[{"end", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"end", "-", "start"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "v"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", ".", 
            RowBox[{"NormalWireSegmentMagneticVectorPotential", "[", 
             RowBox[{
              RowBox[{"t", ".", 
               RowBox[{"(", 
                RowBox[{"p", "-", "start"}], ")"}]}], ",", 
              SqrtBox[
               RowBox[{"v", ".", "v"}]]}], "]"}]}]}]}], "\[IndentingNewLine]",
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]], " ", "current", " ", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"LineSegment", "@@", "#"}], ")"}], "&"}], "/@", 
            RowBox[{"Partition", "[", 
             RowBox[{"positions", ",", "2", ",", "1"}], "]"}]}], ")"}]}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireSegmentMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"ArcSinh", "[", 
        RowBox[{
         RowBox[{"-", "z"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}], "+", 
      RowBox[{"ArcSinh", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"end", "-", "z"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}},
 CellLabel->
  "(Debug) In[88]:=",ExpressionUUID->"d322bf2a-3f52-451f-a245-44956e866b47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", " ", 
      RowBox[{"l", ":", 
       RowBox[{"WireSegment", "[", 
        RowBox[{
         RowBox[{"positions", ":", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
         ",", "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LineSegment", ",", "t", ",", "s"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LineSegment", "[", 
         RowBox[{
          RowBox[{"start", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
          RowBox[{"end", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"end", "-", "start"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "v"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", ".", 
            RowBox[{"NormalWireSegmentMagneticInduction", "[", 
             RowBox[{
              RowBox[{"t", ".", 
               RowBox[{"(", 
                RowBox[{"p", "-", "start"}], ")"}]}], ",", 
              SqrtBox[
               RowBox[{"v", ".", "v"}]]}], "]"}]}]}]}], "\[IndentingNewLine]",
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]], " ", "current", " ", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"LineSegment", "@@", "#"}], ")"}], "&"}], "/@", 
            RowBox[{"Partition", "[", 
             RowBox[{"positions", ",", "2", ",", "1"}], "]"}]}], ")"}]}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireSegmentMagneticInduction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "y"}], ",", "x", ",", "0"}], "}"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["z", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox["z", "2"]}]]], "+", 
       FractionBox[
        RowBox[{"end", "-", "z"}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"end", "-", "z"}], ")"}], "2"]}]]]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}]}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}, {3.8268753528142853`*^9, 
   3.826875374554281*^9}, {3.826875417499666*^9, 3.826875430231484*^9}, {
   3.8270301469637537`*^9, 3.827030209108656*^9}, {3.827030256616678*^9, 
   3.827030320902932*^9}, {3.8270304261370296`*^9, 3.827030484164824*^9}, {
   3.82703054679764*^9, 3.827030605562379*^9}, 3.827035420463244*^9, {
   3.827035603574527*^9, 3.82703565290807*^9}, {3.827035704402665*^9, 
   3.8270357327536697`*^9}, {3.8270357686114473`*^9, 3.82703577738589*^9}, {
   3.827035809568934*^9, 3.8270358684709463`*^9}, {3.82703596146145*^9, 
   3.8270359620031357`*^9}, {3.827036000472475*^9, 3.827036016781146*^9}, {
   3.8270360475435553`*^9, 3.8270360512084*^9}, {3.8270360875096292`*^9, 
   3.82703610951472*^9}, {3.827036146810581*^9, 3.8270361545823317`*^9}, {
   3.827036214474666*^9, 3.827036309052279*^9}, {3.8270363910747013`*^9, 
   3.8270364088746967`*^9}, {3.827036467800501*^9, 3.827036524165124*^9}, {
   3.82703656367459*^9, 3.827036587516924*^9}, {3.8270366215148993`*^9, 
   3.827036647520734*^9}, {3.827036691281289*^9, 3.827036693544322*^9}, {
   3.8270367267258883`*^9, 3.8270367361880207`*^9}, {3.827036791232396*^9, 
   3.827036800051235*^9}, {3.827036844296672*^9, 3.827036901952581*^9}, {
   3.827036952705543*^9, 3.827037000171769*^9}, 3.827037039815436*^9, {
   3.8270371607044497`*^9, 3.827037242635545*^9}, {3.827037287851509*^9, 
   3.827037391012231*^9}, {3.827037547937131*^9, 3.827037556675949*^9}, {
   3.827038082577335*^9, 3.827038093301518*^9}, {3.827038142947143*^9, 
   3.82703817102861*^9}, 3.8270407987428493`*^9, 3.827040914472836*^9, {
   3.827040960190477*^9, 3.827040962029738*^9}, {3.827045058455051*^9, 
   3.827045069592227*^9}, {3.827045512226735*^9, 3.827045514549768*^9}},
 CellLabel->
  "(Debug) In[90]:=",ExpressionUUID->"4fbdc0c9-8902-4d34-b6f7-d153f3a98bf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireSegment", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "___"}], "}"}]}], 
        ",", "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"LineSegment", ",", "t", ",", "s"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"LineSegment", "[", 
         RowBox[{
          RowBox[{"start", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
          RowBox[{"end", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"end", "-", "start"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"t", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "v"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", ".", 
            RowBox[{"NormalWireSegmentMMagneticInductionGradient", "[", 
             RowBox[{
              RowBox[{"t", ".", 
               RowBox[{"(", 
                RowBox[{"p", "-", "start"}], ")"}]}], ",", 
              SqrtBox[
               RowBox[{"v", ".", "v"}]]}], "]"}]}]}]}], "\[IndentingNewLine]",
          "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]], " ", "current", " ", 
        RowBox[{"(", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"LineSegment", "@@", "#"}], ")"}], "&"}], "/@", 
            RowBox[{"Partition", "[", 
             RowBox[{"positions", ",", "2", ",", "1"}], "]"}]}], ")"}]}], 
         ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireSegmentMMagneticInductionGradient", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.827047265789041*^9, 
   3.827047305559258*^9}, 3.827053237443314*^9},
 CellLabel->
  "(Debug) In[92]:=",ExpressionUUID->"1dc700b2-303e-41cc-909d-1e86ca3e1701"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireRectangle: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 
  3.827047148729266*^9}},ExpressionUUID->"0fab3031-2551-4d14-91c6-\
f53430eb8a89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
     RowBox[{"r", ":", 
      RowBox[{"WireRectangle", "[", 
       RowBox[{
        RowBox[{"position", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"direction", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
        "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", "0"}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270461659245872`*^9}},
 CellLabel->
  "(Debug) In[94]:=",ExpressionUUID->"8f1aa924-c559-4dda-bf24-6fd89087004a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"WireRectangle", "[", 
        RowBox[{
         RowBox[{"position", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"xedge_", ",", "yedge_", ",", "angle_"}], "}"}], ",", 
         "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"direction", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"direction", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"angle", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{
             RowBox[{"-", "angle"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "direction"}], 
              "}"}], "]"}], ".", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"angle", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{
            RowBox[{"RotationMatrix", "[", 
             RowBox[{
              RowBox[{"-", "angle"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ".", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"direction", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
             "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", ".", 
        RowBox[{"NormalWireRectangleMagneticInduction", "[", 
         RowBox[{
          RowBox[{"t", ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", "position"}], 
            ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"xedge", ",", "yedge"}], "}"}], ",", "current"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireRectangleMagneticInduction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xedge_", ",", "yedge_"}], "}"}], ",", "current_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Mu]0", "=", 
        RowBox[{"4", "\[Pi]", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "7"}]]}]}], ",", "C", ",", "d", ",", "r"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"C", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["xedge", "2"], "+", "x"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           FractionBox["xedge", "2"], "-", "x"}], ")"}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["xedge", "2"], "-", "x"}], ")"}]}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["xedge", "2"], "+", "x"}], ")"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"y", "+", 
           FractionBox["yedge", "2"]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"y", "+", 
           FractionBox["yedge", "2"]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"y", "-", 
           FractionBox["yedge", "2"]}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"y", "-", 
           FractionBox["yedge", "2"]}], ")"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"r", "=", 
       RowBox[{"{", 
        RowBox[{
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"C", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"d", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "2"], "+", 
           SuperscriptBox["z", "2"]}]], ",", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"C", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"d", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "2"], "+", 
           SuperscriptBox["z", "2"]}]], ",", "\[IndentingNewLine]", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"C", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"d", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "2"], "+", 
           SuperscriptBox["z", "2"]}]], ",", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"C", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"d", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "2"], "+", 
           SuperscriptBox["z", "2"]}]]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "||", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "||", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "||", 
         RowBox[{
          RowBox[{"r", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Mu]0", " ", "current"}], 
          RowBox[{"4", "\[Pi]"}]], " ", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"#", "+", "1"}]], " ", "z"}], 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "+", 
                  RowBox[{"d", "[", 
                   RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}]], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", "4", "]"}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Mu]0", " ", "current"}], 
          RowBox[{"4", "\[Pi]"}]], " ", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              FractionBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"-", "1"}], ")"}], 
                 RowBox[{"#", "+", "1"}]], " ", "z"}], 
               RowBox[{
                RowBox[{"r", "[", 
                 RowBox[{"[", "#", "]"}], "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], "+", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"#", "+", "1"}]], 
                   RowBox[{"C", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}]}]], ")"}], 
             "&"}], "/@", 
            RowBox[{"Range", "[", "4", "]"}]}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Mu]0", " ", "current"}], 
          RowBox[{"4", "\[Pi]"}]], " ", 
         RowBox[{"Plus", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{"-", "1"}], ")"}], "#"], 
                 RowBox[{"d", "[", 
                  RowBox[{"[", "#", "]"}], "]"}]}], 
                RowBox[{
                 RowBox[{"r", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "+", 
                   RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"-", "1"}], ")"}], 
                    RowBox[{"#", "+", "1"}]], 
                    RowBox[{"C", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}]}], ")"}]}]], "-", 
               RowBox[{"(", 
                FractionBox[
                 RowBox[{"C", "[", 
                  RowBox[{"[", "#", "]"}], "]"}], 
                 RowBox[{
                  RowBox[{"r", "[", 
                   RowBox[{"[", "#", "]"}], "]"}], 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "+", 
                    RowBox[{"d", "[", 
                    RowBox[{"[", "#", "]"}], "]"}]}], ")"}]}]], ")"}]}], 
              ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", "4", "]"}]}], ")"}]}]}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}},
 CellLabel->
  "(Debug) In[95]:=",ExpressionUUID->"1508e008-7117-4a95-930e-7a103e920b8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438494789117*^9, 3.8264386328982277`*^9}, {3.826438668206491*^9, 
   3.826438669249132*^9}, {3.826438701514592*^9, 3.826438705964128*^9}, {
   3.826438825585676*^9, 3.826438841887485*^9}, {3.826439068883943*^9, 
   3.826439254832323*^9}, {3.826439295015922*^9, 3.8264393100521708`*^9}, {
   3.826439595952524*^9, 3.826439624620823*^9}, {3.826439775336883*^9, 
   3.826439826155382*^9}, {3.8264437091779423`*^9, 3.8264437566804733`*^9}, {
   3.826443787811108*^9, 3.826443807964608*^9}, {3.826443987828515*^9, 
   3.8264440305660686`*^9}, {3.826444256577907*^9, 3.826444277550194*^9}, {
   3.826444308916394*^9, 3.826444480579029*^9}, {3.826444512368125*^9, 
   3.826444565903624*^9}, {3.8264448817311487`*^9, 3.826445042639819*^9}, {
   3.826445081422184*^9, 3.826445088923149*^9}, {3.826445123106729*^9, 
   3.826445311242075*^9}, {3.826445350360032*^9, 3.8264454289856033`*^9}, {
   3.826445460675333*^9, 3.82644548943817*^9}, {3.826445583698616*^9, 
   3.8264459461447763`*^9}, {3.826529640531324*^9, 3.826529795846363*^9}, 
   3.826609951004367*^9, {3.8267056896520777`*^9, 3.82670569750711*^9}, {
   3.8267088379740887`*^9, 3.826708844288739*^9}},
 CellLabel->
  "(Debug) In[97]:=",ExpressionUUID->"c58b111b-6cbe-4c8e-b6ab-dfb95ae98378"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireCircle: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 
  3.827047137551278*^9}},ExpressionUUID->"f1308000-3686-4146-9b28-\
58375bb17e7f"],

Cell["\<\
This implementation is taken from Urankar\[CloseCurlyQuote]s paper \
\[OpenCurlyDoubleQuote]Vector Potential and Magnetic Field of Current \
Carrying Finite Arc Segment in Analytical Form, Part I: Filament \
Approximation.\[CloseCurlyDoubleQuote] IEEE Transactions on Magnetics, Vol. \
Mag-16, No.5, 1980.\
\>", "Text",
 CellChangeTimes->{{3.8272180857016993`*^9, 
  3.8272182206634912`*^9}},ExpressionUUID->"898f471f-b474-4eba-b6ca-\
4e391f58f2ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "0"}], "}"}]}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"position", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"position", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "s", ",", "CylindricalToCartesian", ",", 
        "CartesianToCylindrical"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"CylindricalToCartesian", "[", 
         RowBox[{"{", 
          RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CartesianToCylindrical", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"y", ",", "x"}], "]"}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"direction", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"direction", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"s", "=", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "direction"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"direction", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", ".", 
        RowBox[{"CylindricalToCartesian", "[", 
         RowBox[{"NormalWireCircleMagneticInduction", "[", 
          RowBox[{
           RowBox[{"CartesianToCylindrical", "[", 
            RowBox[{"t", ".", 
             RowBox[{"(", 
              RowBox[{"p", "-", "position"}], ")"}]}], "]"}], ",", "radius", 
           ",", "current"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireCircleMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", "radius_", ",", 
     "current_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a2", ",", "k2", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"a2", "=", 
       RowBox[{
        RowBox[{"z", "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"radius", "+", "r"}], ")"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k2", "=", 
       RowBox[{"4", " ", "r", " ", 
        RowBox[{"radius", "/", "a2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       SqrtBox["k2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"radius", "/", "r"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"k2", "/", "2"}]}], ")"}], 
          RowBox[{"EllipticK", "[", "k", "]"}]}], "-", 
         RowBox[{"EllipticE", "[", "k", "]"}]}], ")"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270461659245872`*^9}, {3.8272191393180237`*^9, 
   3.827219266187107*^9}, {3.827219304500059*^9, 3.8272193671586933`*^9}, {
   3.827219436622683*^9, 3.827219441321971*^9}, {3.827219962428446*^9, 
   3.827220051800948*^9}, {3.827220122767766*^9, 3.827220151154242*^9}, {
   3.827220183432127*^9, 3.82722018411697*^9}, {3.8272207274362173`*^9, 
   3.827220772780446*^9}, {3.827220805345005*^9, 3.8272208347193604`*^9}, {
   3.8272208691338797`*^9, 3.8272208822464743`*^9}, {3.8272215208960257`*^9, 
   3.827221523972458*^9}, {3.827221640513015*^9, 3.8272217123902903`*^9}, 
   3.827221746738884*^9, 3.827221779966756*^9, {3.82722183174438*^9, 
   3.827221837585685*^9}},
 CellLabel->
  "(Debug) In[99]:=",ExpressionUUID->"fd391bd1-7151-40f7-8838-33aa85f85d16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
      RowBox[{"WireCircle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", "0", ",", "_", ",", 
        "_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"Indeterminate", ",", "Indeterminate", ",", "Indeterminate"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"position", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"direction", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"direction", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"s", "=", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "direction"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"direction", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", ".", 
        RowBox[{"NormalWireCircleMagneticInduction", "[", 
         RowBox[{
          RowBox[{"t", ".", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "y", ",", "z"}], "}"}], "-", "position"}], 
            ")"}]}], ",", "radius", ",", "current"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalWireCircleMagneticInduction", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "radius_", ",", 
      "current_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rad2", ",", "r2", ",", "\[Rho]2", ",", "\[Alpha]2", ",", "\[Beta]2", 
        ",", "\[Gamma]", ",", "k2", ",", "tmp", ",", 
        RowBox[{"\[Mu]0", "=", 
         RowBox[{"4", "\[Pi]", " ", 
          SuperscriptBox["10", 
           RowBox[{"-", "7"}]]}]}], ",", 
        RowBox[{"big", "=", "1000"}], ",", " ", 
        RowBox[{"verybig", "=", "1000000"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rad2", "=", 
        SuperscriptBox["radius", "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r2", "=", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Rho]2", "=", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Rho]2", "\[LessEqual]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"radius", "/", "verybig"}], ")"}], "2"]}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", " ", 
          RowBox[{"\[Mu]0", " ", "current", " ", "rad2", " ", 
           RowBox[{"{", 
            RowBox[{
             FractionBox[
              RowBox[{"0.75", " ", "x", " ", "z"}], 
              RadicalBox[
               RowBox[{"rad2", "+", 
                SuperscriptBox["z", "2"]}], 
               RowBox[{"5", "/", "2"}]]], ",", 
             FractionBox[
              RowBox[{"0.75", " ", "y", " ", "z"}], 
              RadicalBox[
               RowBox[{"rad2", "+", 
                SuperscriptBox["z", "2"]}], 
               RowBox[{"5", "/", "2"}]]], ",", 
             FractionBox[
              RowBox[{"0.5", " "}], 
              RadicalBox[
               RowBox[{"rad2", "+", 
                SuperscriptBox["z", "2"]}], 
               RowBox[{"3", "/", "2"}]]]}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Escape", " ", "formula", " ", "for", " ", "positions", " ", "close", 
         " ", "to", " ", "the", " ", "axis"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r2", ">", 
          RowBox[{"rad2", " ", "big"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Mu]0", " ", "current", " ", "rad2"}], 
            RowBox[{"2", 
             RadicalBox["r2", 
              RowBox[{"3", "/", "2"}]]}]], 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Escape", " ", "formula", " ", "for", " ", "positions", " ", "far", 
         " ", "from", " ", "the", " ", "axis"}], " ", "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]2", "=", 
        RowBox[{"rad2", "+", "r2", "-", 
         RowBox[{"2", " ", "radius", " ", 
          SqrtBox["\[Rho]2"]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]2", "=", 
        RowBox[{"rad2", "+", "r2", "+", 
         RowBox[{"2", " ", "radius", " ", 
          SqrtBox["\[Rho]2"]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "-", 
         RowBox[{"y", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"k2", "=", 
        RowBox[{"1", "-", 
         RowBox[{"\[Alpha]2", "/", "\[Beta]2"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         SuperscriptBox["k", "2"], "=", " ", "m"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Mu]0", " ", "current"}], 
         RowBox[{"2", "\[Pi]", " ", "\[Alpha]2", " ", 
          SqrtBox["\[Beta]2"]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"x", " ", "z"}], "\[Rho]2"], 
           RowBox[{"(", 
            RowBox[{"tmp", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"rad2", "+", "r2"}], ")"}], 
                RowBox[{"EllipticE", "[", "k2", "]"}]}], "-", 
               RowBox[{"\[Alpha]2", " ", 
                RowBox[{"EllipticK", "[", "k2", "]"}]}]}], ")"}]}], ")"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           FractionBox[
            RowBox[{"y", " ", "z"}], "\[Rho]2"], "tmp"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rad2", "-", "r2"}], ")"}], 
             RowBox[{"EllipticE", "[", "k2", "]"}]}], "+", 
            RowBox[{"\[Alpha]2", " ", 
             RowBox[{"EllipticK", "[", "k2", "]"}]}]}], ")"}]}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], " "}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}},
 CellLabel->
  "(Debug) In[102]:=",ExpressionUUID->"1cbda0bb-417c-484d-a7c6-8317392519cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"l", ":", 
       RowBox[{"WireCircle", "[", 
        RowBox[{
         RowBox[{"position", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
         RowBox[{"direction", ":", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
         "current_", ",", "color_"}], "]"}]}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "s", ",", "CylindricalToCartesian", ",", 
        "CartesianToCylindrical", ",", "IntermediateTensor"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"CylindricalToCartesian", "[", 
         RowBox[{"{", 
          RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CartesianToCylindrical", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"y", ",", "x"}], "]"}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"direction", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"direction", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"s", "=", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "direction"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"direction", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"IntermediateTensor", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"CylindricalToCartesian", "[", "#", "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"CylindricalToCartesian", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"Transpose", "[", 
            RowBox[{"NormalWireCircleMagneticInductionGradient", "[", 
             RowBox[{
              RowBox[{"CartesianToCylindrical", "[", 
               RowBox[{"t", ".", 
                RowBox[{"(", 
                 RowBox[{"p", "-", "position"}], ")"}]}], "]"}], ",", 
              "radius", ",", "current"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"s", ".", "IntermediateTensor", ".", 
        RowBox[{"Transpose", "[", "s", "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CASE", " ", "evaluation", " ", "point", " ", "on", " ", "loop"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalWireCircleMagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"radius_", ",", "\[Phi]_", ",", "0"}], "}"}], ",", "radius_", 
      ",", "current_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CASE", " ", "evaluation", " ", "point", " ", "on", " ", "axis"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalWireCircleMagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", "radius_", ",", 
      "current_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "r1", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r1", "=", "radius"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "3"}], "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"-", "z"}], ")"}], " ", 
            RowBox[{
             RowBox[{"r1", "^", "2"}], "/", 
             RowBox[{"(", 
              RowBox[{"2", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"z", "^", "2"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"5", "/", "2"}], ")"}]}]}], ")"}]}]}], ",", "0", ",",
            "0"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"3", "\[Pi]", " ", 
            RowBox[{"(", 
             RowBox[{"-", "z"}], ")"}], " ", 
            RowBox[{
             RowBox[{"r1", "^", "2"}], "/", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"z", "^", "2"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "^", 
              RowBox[{"(", 
               RowBox[{"5", "/", "2"}], ")"}]}]}]}]}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CASE", " ", "any", " ", "other", " ", "point"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"NormalWireCircleMagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", "radius_", ",", 
      "current_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "k"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r1", "=", "radius"}], ";", "\[IndentingNewLine]", 
       RowBox[{"k", "=", 
        SqrtBox[
         RowBox[{"4", " ", "r", " ", 
          RowBox[{"r1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "z"}], ")"}], "^", "2"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}]}]}]]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "r", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "^", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"3", "/", "2"}], ")"}]}], 
            RowBox[{"k", "^", "2"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"k", "^", "2"}]}], ")"}]}]], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "z"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"P", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticK", "[", "k", "]"}]}], "+", 
               RowBox[{
                RowBox[{"Q", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticE", "[", "k", "]"}]}]}], ")"}]}], ",", "0", 
            ",", 
            RowBox[{
             RowBox[{"k", "^", "2"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"S", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticK", "[", "k", "]"}]}], "+", 
               RowBox[{
                RowBox[{"T", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticE", "[", "k", "]"}]}]}], ")"}]}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"2", " ", "r", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"z", "^", "2"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"3", "/", "2"}], ")"}]}], 
            RowBox[{"k", "^", "2"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"k", "^", "2"}]}], ")"}]}]], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"S", "[", 
                RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
               RowBox[{"EllipticK", "[", "k", "]"}]}], "+", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
               RowBox[{"EllipticE", "[", "k", "]"}]}]}], ")"}], ",", "0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "z"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"U", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticK", "[", "k", "]"}]}], "+", 
               RowBox[{
                RowBox[{"V", "[", 
                 RowBox[{"r", ",", "z", ",", "r1", ",", "k"}], "]"}], 
                RowBox[{"EllipticE", "[", "k", "]"}]}]}], ")"}]}]}], 
           "}"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r1", "+", "r"}], ")"}], 
     RowBox[{"k", "^", "4"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", "r1"}], "-", "r"}], ")"}], 
     RowBox[{"k", "^", "2"}]}], "-", 
    RowBox[{"8", "r1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Q", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"k", "^", "2"}]}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], " ", 
       RowBox[{"k", "^", "6"}]}], "-", 
      RowBox[{"r", " ", 
       RowBox[{"k", "^", "4"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", "r1"}], "-", "r"}], ")"}], 
       RowBox[{"k", "^", "2"}]}], "+", 
      RowBox[{"4", "r1"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"k", "^", "2"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"z", "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}]}], "-", 
    RowBox[{"2", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"k", "^", "2"}]}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}], "-", 
         RowBox[{"z", "^", "2"}]}], ")"}], 
       RowBox[{"k", "^", "4"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"z", "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}], ")"}], "+", 
         RowBox[{"2", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}]}], ")"}], 
       RowBox[{"k", "^", "2"}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "r"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r1", "+", "r"}], ")"}], 
     RowBox[{"k", "^", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"r_", ",", "z_", ",", "r1_", ",", "k_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"k", "^", "2"}]}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], 
       RowBox[{"k", "^", "4"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "r1"}], "+", "r"}], ")"}], 
       RowBox[{"k", "^", "2"}]}], "+", "r"}], ")"}]}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438494789117*^9, 3.8264386328982277`*^9}, {3.826438668206491*^9, 
   3.826438669249132*^9}, {3.826438701514592*^9, 3.826438705964128*^9}, {
   3.826438825585676*^9, 3.826438841887485*^9}, {3.826439068883943*^9, 
   3.826439254832323*^9}, {3.826439295015922*^9, 3.8264393100521708`*^9}, {
   3.826439595952524*^9, 3.826439624620823*^9}, {3.826439775336883*^9, 
   3.826439826155382*^9}, {3.8264437091779423`*^9, 3.8264437566804733`*^9}, {
   3.826443787811108*^9, 3.826443807964608*^9}, {3.826443987828515*^9, 
   3.8264440305660686`*^9}, {3.826444256577907*^9, 3.826444277550194*^9}, {
   3.826444308916394*^9, 3.826444480579029*^9}, {3.826444512368125*^9, 
   3.826444565903624*^9}, {3.8264448817311487`*^9, 3.826445042639819*^9}, {
   3.826445081422184*^9, 3.826445088923149*^9}, {3.826445123106729*^9, 
   3.826445311242075*^9}, {3.826445350360032*^9, 3.8264454289856033`*^9}, {
   3.826445460675333*^9, 3.82644548943817*^9}, {3.826445583698616*^9, 
   3.8264459461447763`*^9}, {3.826529640531324*^9, 3.826529795846363*^9}, 
   3.826609951004367*^9, {3.8267056896520777`*^9, 3.826705692897777*^9}, 
   3.826870167392455*^9, 3.8268714304025097`*^9, {3.8268714971773367`*^9, 
   3.826871501825674*^9}, 3.827047327350659*^9, {3.8272223135512247`*^9, 
   3.827222321790676*^9}, {3.8272223765629883`*^9, 3.827222397182819*^9}, {
   3.827222428907645*^9, 3.827222431996612*^9}, {3.827222550889234*^9, 
   3.827222854810685*^9}, {3.82722290709442*^9, 3.827222930306107*^9}, {
   3.827222976065915*^9, 3.827223078553109*^9}, {3.82722313909933*^9, 
   3.827223173626651*^9}, {3.827223205314406*^9, 3.827223245743923*^9}, 
   3.8272233216279993`*^9, {3.827223366607298*^9, 3.827223693322884*^9}, {
   3.827223786151561*^9, 3.827223915801709*^9}, {3.8272240212393103`*^9, 
   3.827224049549451*^9}, {3.827224081567708*^9, 3.827224156723077*^9}, {
   3.8272242071244392`*^9, 3.827224578709715*^9}, {3.8272246199586067`*^9, 
   3.827224674054228*^9}, {3.8272247056405363`*^9, 3.827224922573167*^9}, {
   3.827224978519637*^9, 3.827224987107339*^9}, {3.82722510802472*^9, 
   3.82722511497066*^9}, {3.827225223031644*^9, 3.827225272339003*^9}, {
   3.827225325641728*^9, 3.827225331262146*^9}, {3.82722538191175*^9, 
   3.827225496941567*^9}, {3.827225541796947*^9, 3.827225602226583*^9}, {
   3.8272256747095013`*^9, 3.827225682603032*^9}, {3.827229872665681*^9, 
   3.827229886768403*^9}},
 CellLabel->
  "(Debug) In[105]:=",ExpressionUUID->"ac56d377-67d2-4050-9d97-b38c261e93ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireCircularArc: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.82705169278617*^9, 
  3.827051697768113*^9}},ExpressionUUID->"52788b74-e0fb-4de8-a1ff-\
e50eeda9252c"],

Cell["\<\
This implementation is taken from Urankar\[CloseCurlyQuote]s paper \
\[OpenCurlyDoubleQuote]Vector Potential and Magnetic Field of Current \
Carrying Finite Arc Segment in Analytical Form, Part I: Filament \
Approximation.\[CloseCurlyDoubleQuote] IEEE Transactions on Magnetics, Vol. \
Mag-16, No.5, 1980.\
\>", "Text",
 CellChangeTimes->{{3.8272180857016993`*^9, 
  3.8272182206634912`*^9}},ExpressionUUID->"dd5a7007-381e-4d8f-b0db-\
5f396af3abdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireCircularArc", "[", 
       RowBox[{
        RowBox[{"position", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"direction", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "radius_", ",", 
        RowBox[{"{", 
         RowBox[{"\[Phi]1_", ",", "\[Phi]2_"}], "}"}], ",", "current_", ",", 
        "color_"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "t", ",", "s", ",", "CylindricalToCartesian", ",", 
        "CartesianToCylindrical", ",", "r", ",", "\[Phi]", ",", "\[Zeta]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"CylindricalToCartesian", "[", 
         RowBox[{"{", 
          RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r", " ", 
           RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
          RowBox[{"r", " ", 
           RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CartesianToCylindrical", "[", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], "]"}], ":=", 
        RowBox[{"{", 
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          RowBox[{"ArcTan", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", "z"}], "}"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"direction", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", 
          RowBox[{"direction", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"t", "=", 
          RowBox[{"s", "=", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "direction"}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"RotationMatrix", "[", 
            RowBox[{"{", 
             RowBox[{"direction", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}]}],
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", ".", 
        RowBox[{"CylindricalToCartesian", "[", "\[IndentingNewLine]", 
         RowBox[{"NormalWireCircularArcMagneticVectorPotential", "[", 
          RowBox[{
           RowBox[{"CartesianToCylindrical", "[", 
            RowBox[{
             RowBox[{"t", ".", "p"}], "-", "position"}], "]"}], ",", 
           "\[Phi]1", ",", "\[Phi]2", ",", "radius", ",", "0"}], "]"}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "returns", " ", "a", " ", "vector", " ", 
    "in", " ", "cylindrical", " ", "coordinates"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireCircularArcMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r_", ",", "\[Phi]_", ",", "z_"}], "}"}], ",", "\[Phi]1_", ",", 
     "\[Phi]2_", ",", "r1_", ",", "z1_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "a", ",", "a2", ",", "k2", ",", "\[Alpha]1", ",", "\[Alpha]2", ",", 
       "ui", ",", "Ahat", ",", "ToCartesian", ",", "u"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Ahat", "[", "\[Alpha]i_", "]"}], ":=", "\[IndentingNewLine]", 
       
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", "\[Alpha]i", "]"}], "\[LessEqual]", 
          RowBox[{"\[Pi]", "/", "2"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ui", "=", 
           RowBox[{"u", "/.", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"JacobiAmplitude", "[", 
                RowBox[{"u", ",", "k2"}], "]"}], "-", 
               RowBox[{"Abs", "[", "\[Alpha]i", "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "/", "r"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"JacobiDN", "[", 
              RowBox[{"ui", ",", "k2"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sign", "[", "\[Alpha]i", "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"k2", "/", "2"}]}], ")"}], 
                 RowBox[{"EllipticF", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", "\[Alpha]i", "]"}], ",", 
                   SqrtBox["k2"]}], "]"}]}], "+", 
                RowBox[{"EllipticE", "[", 
                 RowBox[{
                  RowBox[{"Abs", "[", "\[Alpha]i", "]"}], ",", 
                  SqrtBox["k2"]}], "]"}]}], ")"}]}], ",", "0"}], "}"}]}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ui", "=", 
           RowBox[{"u", "/.", 
            RowBox[{"FindRoot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"JacobiAmplitude", "[", 
                RowBox[{"u", ",", "k2"}], "]"}], "-", 
               RowBox[{"(", 
                RowBox[{"\[Pi]", "-", 
                 RowBox[{"Abs", "[", "\[Alpha]i", "]"}]}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"u", ",", "0"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"a", "/", "r"}], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"JacobiDN", "[", 
              RowBox[{"ui", ",", "k2"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Sign", "[", "\[Alpha]i", "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"k2", "/", "2"}]}], ")"}], 
                 RowBox[{"EllipticF", "[", 
                  RowBox[{
                   RowBox[{"\[Pi]", "/", "2"}], ",", 
                   SqrtBox["k2"]}], "]"}]}], "+", 
                RowBox[{"2", 
                 RowBox[{"EllipticE", "[", 
                  RowBox[{
                   RowBox[{"\[Pi]", "/", "2"}], ",", 
                   SqrtBox["k2"]}], "]"}]}], "-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"k2", "/", "2"}]}], ")"}], 
                 RowBox[{"EllipticF", "[", 
                  RowBox[{
                   RowBox[{"\[Pi]", "-", 
                    RowBox[{"Abs", "[", "\[Alpha]i", "]"}]}], ",", 
                   SqrtBox["k2"]}], "]"}]}], "-", 
                RowBox[{"EllipticE", "[", 
                 RowBox[{
                  RowBox[{"\[Pi]", "-", 
                   RowBox[{"Abs", "[", "\[Alpha]i", "]"}]}], ",", 
                  SqrtBox["k2"]}], "]"}]}], ")"}]}], ",", "0"}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]1", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Pi]", "+", "\[Phi]", "-", "\[Phi]1"}], ")"}], "/", 
        "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Pi]", "+", "\[Phi]", "-", "\[Phi]2"}], ")"}], "/", 
        "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"z1", "-", "z"}], ")"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"r1", "+", "r"}], ")"}], "^", "2"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       SqrtBox["a2"]}], ";", "\[IndentingNewLine]", 
      RowBox[{"k2", "=", 
       RowBox[{"4", " ", "r", " ", 
        RowBox[{"r1", "/", "a2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Ahat", "[", "\[Alpha]1", "]"}], "-", 
        RowBox[{"Ahat", "[", "\[Alpha]2", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827051974003695*^9, 3.827051977862768*^9}, {3.827052011875558*^9, 
   3.827052125502076*^9}, {3.827136544103015*^9, 3.8271365504365263`*^9}, {
   3.8271365949716187`*^9, 3.8271366398968773`*^9}, {3.827137015855967*^9, 
   3.827137226353483*^9}, {3.827137288869791*^9, 3.82713738477339*^9}, {
   3.82713745237999*^9, 3.8271374617471027`*^9}, {3.827137499373486*^9, 
   3.827137572574535*^9}, {3.827137665749757*^9, 3.8271376748632717`*^9}, {
   3.827137725078631*^9, 3.82713775754677*^9}, {3.82713778766848*^9, 
   3.827137793712089*^9}, {3.827137835205392*^9, 3.82713783557045*^9}, {
   3.827137989908922*^9, 3.827138010405051*^9}, {3.827138983816987*^9, 
   3.827139079807465*^9}, 3.8271393123204308`*^9, 3.827139342656721*^9, {
   3.8271395944496317`*^9, 3.8271396033722887`*^9}, {3.8271400293695927`*^9, 
   3.827140031366295*^9}, 3.827140073754925*^9, {3.827140109082726*^9, 
   3.8271403651698008`*^9}, {3.8271404033987923`*^9, 3.827140469933395*^9}, {
   3.827140508505406*^9, 3.827140516934106*^9}, {3.8271405608664427`*^9, 
   3.8271406258223877`*^9}, {3.827141283309948*^9, 3.827141298147956*^9}, {
   3.8271421286996393`*^9, 3.827142184117412*^9}, {3.827142708043885*^9, 
   3.8271427141476*^9}, {3.82714275088205*^9, 3.8271428684266357`*^9}, {
   3.827143005123424*^9, 3.827143044592341*^9}, {3.827143122335514*^9, 
   3.82714315004712*^9}, {3.827143282569422*^9, 3.8271433031962013`*^9}, {
   3.82714342059618*^9, 3.827143427094111*^9}, {3.8271435236034927`*^9, 
   3.827143543099648*^9}, {3.827143614141364*^9, 3.827143652231251*^9}, {
   3.827143682701467*^9, 3.827143717092573*^9}, {3.827144269379095*^9, 
   3.8271443330801888`*^9}, {3.8271444785014563`*^9, 3.827144639268674*^9}, {
   3.8271446833207903`*^9, 3.827144711500511*^9}, {3.82714477453719*^9, 
   3.8271448516835012`*^9}, {3.827144898917894*^9, 3.827144903529505*^9}, {
   3.8271449663075333`*^9, 3.827145113270938*^9}, {3.8271451686533957`*^9, 
   3.82714519002356*^9}, {3.8272062315292683`*^9, 3.827206256543762*^9}, {
   3.827206306622868*^9, 3.827206308621323*^9}, {3.827206347426428*^9, 
   3.827206419854743*^9}, {3.827206456900178*^9, 3.827206463412096*^9}, {
   3.827206511639756*^9, 3.827206519301689*^9}, 3.827206574254497*^9, 
   3.827206626621512*^9, {3.827206672815268*^9, 3.827206676822995*^9}, {
   3.827217925928123*^9, 3.827217926495007*^9}, {3.827218040036001*^9, 
   3.827218050016779*^9}, {3.827218263750472*^9, 3.827218290636539*^9}, {
   3.827218362604331*^9, 3.827218400657044*^9}, 3.827232207998165*^9},
 CellLabel->
  "(Debug) In[115]:=",ExpressionUUID->"608d3fe2-386b-458d-8a9d-1f1608af7f44"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", " ", 
      RowBox[{"WireCircularArc", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireCircularArcMagneticInduction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}, {3.8268753528142853`*^9, 
   3.826875374554281*^9}, {3.826875417499666*^9, 3.826875430231484*^9}, {
   3.8270301469637537`*^9, 3.827030209108656*^9}, {3.827030256616678*^9, 
   3.827030320902932*^9}, {3.8270304261370296`*^9, 3.827030484164824*^9}, {
   3.82703054679764*^9, 3.827030605562379*^9}, 3.827035420463244*^9, {
   3.827035603574527*^9, 3.82703565290807*^9}, {3.827035704402665*^9, 
   3.8270357327536697`*^9}, {3.8270357686114473`*^9, 3.82703577738589*^9}, {
   3.827035809568934*^9, 3.8270358684709463`*^9}, {3.82703596146145*^9, 
   3.8270359620031357`*^9}, {3.827036000472475*^9, 3.827036016781146*^9}, {
   3.8270360475435553`*^9, 3.8270360512084*^9}, {3.8270360875096292`*^9, 
   3.82703610951472*^9}, {3.827036146810581*^9, 3.8270361545823317`*^9}, {
   3.827036214474666*^9, 3.827036309052279*^9}, {3.8270363910747013`*^9, 
   3.8270364088746967`*^9}, {3.827036467800501*^9, 3.827036524165124*^9}, {
   3.82703656367459*^9, 3.827036587516924*^9}, {3.8270366215148993`*^9, 
   3.827036647520734*^9}, {3.827036691281289*^9, 3.827036693544322*^9}, {
   3.8270367267258883`*^9, 3.8270367361880207`*^9}, {3.827036791232396*^9, 
   3.827036800051235*^9}, {3.827036844296672*^9, 3.827036901952581*^9}, {
   3.827036952705543*^9, 3.827037000171769*^9}, 3.827037039815436*^9, {
   3.8270371607044497`*^9, 3.827037242635545*^9}, {3.827037287851509*^9, 
   3.827037391012231*^9}, {3.827037547937131*^9, 3.827037556675949*^9}, {
   3.827038082577335*^9, 3.827038093301518*^9}, {3.827038142947143*^9, 
   3.82703817102861*^9}, 3.8270407987428493`*^9, 3.827040914472836*^9, {
   3.827040960190477*^9, 3.827040962029738*^9}, {3.827045058455051*^9, 
   3.827045069592227*^9}, {3.827045512226735*^9, 3.827045514549768*^9}, {
   3.827051797595359*^9, 3.8270518054441338`*^9}, {3.827051841763608*^9, 
   3.8270518631894903`*^9}, {3.8270519094764767`*^9, 3.827051949423634*^9}, {
   3.827051987303163*^9, 3.827052008996305*^9}, {3.8270520431816463`*^9, 
   3.827052059006961*^9}, {3.8270521078995647`*^9, 3.827052121039673*^9}},
 CellLabel->
  "(Debug) In[117]:=",ExpressionUUID->"04bda687-38fe-4e07-bfc0-4b7a1d089bb9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireCircularArc", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireCircularArcMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.827047265789041*^9, 
   3.827047305559258*^9}, {3.8270518143910923`*^9, 3.8270518154311857`*^9}, {
   3.827051849917603*^9, 3.8270519037624187`*^9}, {3.8270519917799177`*^9, 
   3.827052015633236*^9}, {3.82705204689809*^9, 3.82705205173188*^9}, {
   3.827052113231483*^9, 3.827052116885735*^9}},
 CellLabel->
  "(Debug) In[119]:=",ExpressionUUID->"c1736ab0-3324-429d-9dbf-568a316f2579"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireEllipse: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051701480411*^9, 
  3.827051703312598*^9}},ExpressionUUID->"ff4cb068-a1b5-4fb1-b6db-\
25ad98f30ccf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireEllipse", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipseMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827051974003695*^9, 3.827051977862768*^9}, {3.827052011875558*^9, 
   3.8270520743768263`*^9}},
 CellLabel->
  "(Debug) In[121]:=",ExpressionUUID->"75e433a0-7aaa-4473-bc84-d748abcccb81"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", " ", 
      RowBox[{"WireEllipse", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipseMagneticInduction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}, {3.8268753528142853`*^9, 
   3.826875374554281*^9}, {3.826875417499666*^9, 3.826875430231484*^9}, {
   3.8270301469637537`*^9, 3.827030209108656*^9}, {3.827030256616678*^9, 
   3.827030320902932*^9}, {3.8270304261370296`*^9, 3.827030484164824*^9}, {
   3.82703054679764*^9, 3.827030605562379*^9}, 3.827035420463244*^9, {
   3.827035603574527*^9, 3.82703565290807*^9}, {3.827035704402665*^9, 
   3.8270357327536697`*^9}, {3.8270357686114473`*^9, 3.82703577738589*^9}, {
   3.827035809568934*^9, 3.8270358684709463`*^9}, {3.82703596146145*^9, 
   3.8270359620031357`*^9}, {3.827036000472475*^9, 3.827036016781146*^9}, {
   3.8270360475435553`*^9, 3.8270360512084*^9}, {3.8270360875096292`*^9, 
   3.82703610951472*^9}, {3.827036146810581*^9, 3.8270361545823317`*^9}, {
   3.827036214474666*^9, 3.827036309052279*^9}, {3.8270363910747013`*^9, 
   3.8270364088746967`*^9}, {3.827036467800501*^9, 3.827036524165124*^9}, {
   3.82703656367459*^9, 3.827036587516924*^9}, {3.8270366215148993`*^9, 
   3.827036647520734*^9}, {3.827036691281289*^9, 3.827036693544322*^9}, {
   3.8270367267258883`*^9, 3.8270367361880207`*^9}, {3.827036791232396*^9, 
   3.827036800051235*^9}, {3.827036844296672*^9, 3.827036901952581*^9}, {
   3.827036952705543*^9, 3.827037000171769*^9}, 3.827037039815436*^9, {
   3.8270371607044497`*^9, 3.827037242635545*^9}, {3.827037287851509*^9, 
   3.827037391012231*^9}, {3.827037547937131*^9, 3.827037556675949*^9}, {
   3.827038082577335*^9, 3.827038093301518*^9}, {3.827038142947143*^9, 
   3.82703817102861*^9}, 3.8270407987428493`*^9, 3.827040914472836*^9, {
   3.827040960190477*^9, 3.827040962029738*^9}, {3.827045058455051*^9, 
   3.827045069592227*^9}, {3.827045512226735*^9, 3.827045514549768*^9}, {
   3.827051797595359*^9, 3.8270518054441338`*^9}, {3.827051841763608*^9, 
   3.8270518631894903`*^9}, {3.8270519094764767`*^9, 3.827051949423634*^9}, {
   3.827051987303163*^9, 3.827052008996305*^9}, {3.8270520431816463`*^9, 
   3.827052059006961*^9}},
 CellLabel->
  "(Debug) In[123]:=",ExpressionUUID->"190191f2-3c78-4baf-bb84-6c5583ca9a39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireEllipse", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipseMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.827047265789041*^9, 
   3.827047305559258*^9}, {3.8270518143910923`*^9, 3.8270518154311857`*^9}, {
   3.827051849917603*^9, 3.8270519037624187`*^9}, {3.8270519917799177`*^9, 
   3.827052015633236*^9}, {3.82705204689809*^9, 3.82705205173188*^9}},
 CellLabel->
  "(Debug) In[125]:=",ExpressionUUID->"1db18f4c-e81c-471c-b94e-79d39ebdb2b3"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireEllipsoidalArc: Magnetic Vector Potential, Magnetic Induction, and \
Magnetic Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051706800112*^9, 
  3.827051710154439*^9}},ExpressionUUID->"fe79126f-c611-40f8-9023-\
4f8cdc2d4b7b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireEllipsoidalArc", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipsoidalArcMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827051974003695*^9, 3.827051977862768*^9}, 3.827052011875558*^9},
 CellLabel->
  "(Debug) In[127]:=",ExpressionUUID->"77acc46e-b8dd-4660-b2ff-15648c5fd05b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInduction", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", " ", 
      RowBox[{"WireEllipsoidalArc", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipsoidalArcMagneticInduction", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}, {3.8268753528142853`*^9, 
   3.826875374554281*^9}, {3.826875417499666*^9, 3.826875430231484*^9}, {
   3.8270301469637537`*^9, 3.827030209108656*^9}, {3.827030256616678*^9, 
   3.827030320902932*^9}, {3.8270304261370296`*^9, 3.827030484164824*^9}, {
   3.82703054679764*^9, 3.827030605562379*^9}, 3.827035420463244*^9, {
   3.827035603574527*^9, 3.82703565290807*^9}, {3.827035704402665*^9, 
   3.8270357327536697`*^9}, {3.8270357686114473`*^9, 3.82703577738589*^9}, {
   3.827035809568934*^9, 3.8270358684709463`*^9}, {3.82703596146145*^9, 
   3.8270359620031357`*^9}, {3.827036000472475*^9, 3.827036016781146*^9}, {
   3.8270360475435553`*^9, 3.8270360512084*^9}, {3.8270360875096292`*^9, 
   3.82703610951472*^9}, {3.827036146810581*^9, 3.8270361545823317`*^9}, {
   3.827036214474666*^9, 3.827036309052279*^9}, {3.8270363910747013`*^9, 
   3.8270364088746967`*^9}, {3.827036467800501*^9, 3.827036524165124*^9}, {
   3.82703656367459*^9, 3.827036587516924*^9}, {3.8270366215148993`*^9, 
   3.827036647520734*^9}, {3.827036691281289*^9, 3.827036693544322*^9}, {
   3.8270367267258883`*^9, 3.8270367361880207`*^9}, {3.827036791232396*^9, 
   3.827036800051235*^9}, {3.827036844296672*^9, 3.827036901952581*^9}, {
   3.827036952705543*^9, 3.827037000171769*^9}, 3.827037039815436*^9, {
   3.8270371607044497`*^9, 3.827037242635545*^9}, {3.827037287851509*^9, 
   3.827037391012231*^9}, {3.827037547937131*^9, 3.827037556675949*^9}, {
   3.827038082577335*^9, 3.827038093301518*^9}, {3.827038142947143*^9, 
   3.82703817102861*^9}, 3.8270407987428493`*^9, 3.827040914472836*^9, {
   3.827040960190477*^9, 3.827040962029738*^9}, {3.827045058455051*^9, 
   3.827045069592227*^9}, {3.827045512226735*^9, 3.827045514549768*^9}, {
   3.827051797595359*^9, 3.8270518054441338`*^9}, {3.827051841763608*^9, 
   3.8270518631894903`*^9}, {3.8270519094764767`*^9, 3.827051949423634*^9}, {
   3.827051987303163*^9, 3.827052008996305*^9}},
 CellLabel->
  "(Debug) In[129]:=",ExpressionUUID->"8bcec8bd-4340-4455-b231-00e31b5feda8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticInductionGradient", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"WireEllipsoidalArc", "[", 
       RowBox[{
        RowBox[{"positions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
        "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireEllipsoidalArcMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.827047265789041*^9, 
   3.827047305559258*^9}, {3.8270518143910923`*^9, 3.8270518154311857`*^9}, {
   3.827051849917603*^9, 3.8270519037624187`*^9}, {3.8270519917799177`*^9, 
   3.827052015633236*^9}},
 CellLabel->
  "(Debug) In[131]:=",ExpressionUUID->"7e06caa0-e533-4a27-92c4-71390cacede8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireSpline: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051706800112*^9, 
  3.827051718629752*^9}},ExpressionUUID->"670880d9-ccb7-412a-8bc8-\
ac958fcad2f8"],

Cell["\<\
In this case we have no compact formula, and simply integrate the classical \
expression parametrically over the line segment, in this case a Bezier \
spline. Whereas it provides very general functionality, it is considerably \
slower than using the compact expressions.\
\>", "Text",
 CellChangeTimes->{{3.827118081749411*^9, 
  3.827118179591683*^9}},ExpressionUUID->"4a5fe1bd-d166-43a9-ab0a-\
dcc97862e31b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireSpline", "[", 
      RowBox[{
       RowBox[{"positions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
       "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basis", ",", "dbasis", ",", "equations", ",", "t"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"basis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "3"]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"], "t"}], ",", 
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", 
          SuperscriptBox["t", "2"]}], ",", 
         SuperscriptBox["t", "3"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dbasis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["t", "2"]}]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox["t", "2"]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{"basis", ".", "positions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]], " ", "current", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"dbasis", ".", "positions"}], 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "-", "equations"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"p", "-", "equations"}], ")"}]}], "]"}]], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
           "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9},
 CellLabel->
  "(Debug) In[133]:=",ExpressionUUID->"589bd1fe-7b2e-4889-8019-d10c43342f35"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInduction", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", " ", 
     RowBox[{"WireSpline", "[", 
      RowBox[{
       RowBox[{"positions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
       "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"basis", ",", "dbasis", ",", "equations", ",", "t"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"basis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "3"]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"], "t"}], ",", 
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", 
          SuperscriptBox["t", "2"]}], ",", 
         SuperscriptBox["t", "3"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dbasis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["t", "2"]}]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox["t", "2"]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{"basis", ".", "positions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]], " ", "current", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"dbasis", ".", "positions"}], ",", 
            RowBox[{"(", 
             RowBox[{"p", "-", "equations"}], ")"}]}], "]"}], 
          SuperscriptBox[
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"p", "-", "equations"}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{"p", "-", "equations"}], ")"}]}], "]"}], "3"]], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
           "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874837945236*^9}, {3.8268753528142853`*^9, 
   3.826875374554281*^9}, {3.826875417499666*^9, 3.826875430231484*^9}, {
   3.8270301469637537`*^9, 3.827030209108656*^9}, {3.827030256616678*^9, 
   3.827030320902932*^9}, {3.8270304261370296`*^9, 3.827030484164824*^9}, {
   3.82703054679764*^9, 3.827030605562379*^9}, 3.827035420463244*^9, {
   3.827035603574527*^9, 3.82703565290807*^9}, {3.827035704402665*^9, 
   3.8270357327536697`*^9}, {3.8270357686114473`*^9, 3.82703577738589*^9}, {
   3.827035809568934*^9, 3.8270358684709463`*^9}, {3.82703596146145*^9, 
   3.8270359620031357`*^9}, {3.827036000472475*^9, 3.827036016781146*^9}, {
   3.8270360475435553`*^9, 3.8270360512084*^9}, {3.8270360875096292`*^9, 
   3.82703610951472*^9}, {3.827036146810581*^9, 3.8270361545823317`*^9}, {
   3.827036214474666*^9, 3.827036309052279*^9}, {3.8270363910747013`*^9, 
   3.8270364088746967`*^9}, {3.827036467800501*^9, 3.827036524165124*^9}, {
   3.82703656367459*^9, 3.827036587516924*^9}, {3.8270366215148993`*^9, 
   3.827036647520734*^9}, {3.827036691281289*^9, 3.827036693544322*^9}, {
   3.8270367267258883`*^9, 3.8270367361880207`*^9}, {3.827036791232396*^9, 
   3.827036800051235*^9}, {3.827036844296672*^9, 3.827036901952581*^9}, {
   3.827036952705543*^9, 3.827037000171769*^9}, 3.827037039815436*^9, {
   3.8270371607044497`*^9, 3.827037242635545*^9}, {3.827037287851509*^9, 
   3.827037391012231*^9}, {3.827037547937131*^9, 3.827037556675949*^9}, {
   3.827038082577335*^9, 3.827038093301518*^9}, {3.827038142947143*^9, 
   3.82703817102861*^9}, 3.8270407987428493`*^9, 3.827040914472836*^9, {
   3.827040960190477*^9, 3.827040962029738*^9}, {3.827045058455051*^9, 
   3.827045069592227*^9}, {3.827045512226735*^9, 3.827045514549768*^9}, {
   3.827051797595359*^9, 3.8270518054441338`*^9}, {3.827051841763608*^9, 
   3.8270518631894903`*^9}, {3.8270519094764767`*^9, 3.827051949423634*^9}, {
   3.8271130349348803`*^9, 3.827113091811577*^9}, {3.827117505984955*^9, 
   3.827117682328638*^9}, {3.827117747647944*^9, 3.8271177737213993`*^9}},
 CellLabel->
  "(Debug) In[134]:=",ExpressionUUID->"2c02a8e2-a67a-4612-8a0a-09b40405f9d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInductionGradient", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireSpline", "[", 
      RowBox[{
       RowBox[{"positions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "}"}]}], ",", 
       "current_", ",", "color_"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "basis", ",", "dbasis", ",", "equations", ",", "integrand", ",", 
       "\[Xi]", ",", "\[Eta]", ",", "\[Zeta]", ",", "t"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"basis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "3"]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"], "t"}], ",", 
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", 
          SuperscriptBox["t", "2"]}], ",", 
         SuperscriptBox["t", "3"]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dbasis", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "3"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], ",", 
         RowBox[{
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "t"}], ")"}], "2"]}], "+", 
          RowBox[{"6", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "6"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "t"}], ")"}], " ", "t"}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox["t", "2"]}]}], ",", 
         RowBox[{"3", " ", 
          SuperscriptBox["t", "2"]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"equations", "=", 
       RowBox[{"basis", ".", "positions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"integrand", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             FractionBox[
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"dbasis", ".", "positions"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], 
                  "-", "equations"}], ")"}]}], "]"}], 
              SuperscriptBox[
               RowBox[{"Sqrt", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], 
                   "-", "equations"}], ")"}], ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}], 
                   "-", "equations"}], ")"}]}], "]"}], "3"]], ",", "#"}], 
            "]"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{"\[Xi]", ",", "\[Eta]", ",", "\[Zeta]"}], "}"}]}], ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Xi]", "\[Rule]", "x"}], ",", 
          RowBox[{"\[Eta]", "\[Rule]", "y"}], ",", 
          RowBox[{"\[Zeta]", "\[Rule]", "z"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       SuperscriptBox["10", 
        RowBox[{"-", "7"}]], " ", "current", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{"integrand", ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", 
            RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "False"}]}], 
           "}"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.827047265789041*^9, 
   3.827047305559258*^9}, {3.8270518143910923`*^9, 3.8270518154311857`*^9}, {
   3.827051849917603*^9, 3.8270519037624187`*^9}, {3.827117725617908*^9, 
   3.827117730029915*^9}, 3.82711779553372*^9, {3.827117967542479*^9, 
   3.82711797091638*^9}},
 CellLabel->
  "(Debug) In[135]:=",ExpressionUUID->"996e3b5c-3d06-4f8d-b528-66124ed3b8dc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireGroup: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051706800112*^9, 
  3.827051718629752*^9}, {3.827122313515842*^9, 
  3.827122316178751*^9}},ExpressionUUID->"ff56d509-d9bc-4936-b11e-\
42c0b2d66cc4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireGroup", "[", 
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
           "_WireCircularArc", "|", "_WireEllipse", "|", 
           "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
           "|", "_WireGroup"}], ")"}], ".."}], "}"}]}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticVectorPotential", "[", 
        RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", "g"}], ")"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.827122483545432*^9}},
 CellLabel->
  "(Debug) In[136]:=",ExpressionUUID->"0670c9be-3c7b-48f3-bf5e-39fcc7b81aa2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInduction", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireGroup", "[", 
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
           "_WireCircularArc", "|", "_WireEllipse", "|", 
           "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
           "|", "_WireGroup"}], ")"}], ".."}], "}"}]}], "]"}]}], "]"}], ":=", 
   
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticInduction", "[", 
        RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", "g"}], ")"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.8271224856007032`*^9}, {3.827123286432272*^9, 3.827123309324018*^9}, {
   3.827123341060689*^9, 3.827123348710103*^9}, 3.827123450966176*^9, {
   3.827123502244026*^9, 3.827123505705152*^9}},
 CellLabel->
  "(Debug) In[137]:=",ExpressionUUID->"d18dd4d8-5304-407f-8e04-e158431c80df"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInductionGradient", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireGroup", "[", 
      RowBox[{"g", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
           "_WireCircularArc", "|", "_WireEllipse", "|", 
           "_WireEllipsoidalArc", "|", "_WireSpline", "|", "_WireRepeated", 
           "|", "_WireGroup"}], ")"}], ".."}], "}"}]}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticInductionGradient", "[", 
        RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", "g"}], ")"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.8271224856007032`*^9}},
 CellLabel->
  "(Debug) In[138]:=",ExpressionUUID->"2b46627a-4251-4e04-ac4b-9a72db923a7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireRepeated: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051706800112*^9, 
  3.827051718629752*^9}, {3.827122313515842*^9, 3.827122316178751*^9}, {
  3.8271225011982117`*^9, 
  3.827122503407341*^9}},ExpressionUUID->"7ecc7764-9e86-489a-947f-\
47abb231372c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireRepeated", "[", 
      RowBox[{
       RowBox[{"o", ":", 
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}]}], ",", 
       RowBox[{"offset", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], 
      "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticVectorPotential", "[", 
        RowBox[{
         RowBox[{"p", "+", 
          RowBox[{"offset", " ", "#"}]}], ",", "o"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "nRepeat"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.827122483545432*^9}, 3.827122720329205*^9, {3.827122759647332*^9, 
   3.827122789301836*^9}},
 CellLabel->
  "(Debug) In[139]:=",ExpressionUUID->"100a862d-9cce-4093-adf4-8cbf15fa20fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInduction", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireRepeated", "[", 
      RowBox[{
       RowBox[{"o", ":", 
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}]}], ",", 
       RowBox[{"offset", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], 
      "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticInduction", "[", 
        RowBox[{
         RowBox[{"p", "+", 
          RowBox[{"offset", " ", "#"}]}], ",", "o"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "nRepeat"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.827122483545432*^9}, 3.827122720329205*^9, {3.827122759647332*^9, 
   3.8271228108775454`*^9}},
 CellLabel->
  "(Debug) In[140]:=",ExpressionUUID->"6431e6ac-fa16-4feb-87ce-875274ea1062"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MagneticInductionGradient", "[", 
    RowBox[{
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], ",", 
     RowBox[{"WireRepeated", "[", 
      RowBox[{
       RowBox[{"o", ":", 
        RowBox[{"(", 
         RowBox[{
         "_WireSegment", "|", "_WireRectangle", "|", "_WireCircle", "|", 
          "_WireCircularArc", "|", "_WireEllipse", "|", "_WireEllipsoidalArc",
           "|", "_WireSpline", "|", "_WireRepeated", "|", "_WireGroup"}], 
         ")"}]}], ",", 
       RowBox[{"offset", ":", 
        RowBox[{"{", 
         RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "nRepeat_"}], 
      "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MagneticInductionGradient", "[", 
        RowBox[{
         RowBox[{"p", "+", 
          RowBox[{"offset", " ", "#"}]}], ",", "o"}], "]"}], "&"}], "/@", 
      RowBox[{"Range", "[", 
       RowBox[{"0", ",", "nRepeat"}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, {3.8270517715887203`*^9, 
   3.827051791526268*^9}, {3.827051830580888*^9, 3.82705183260565*^9}, 
   3.827051867358582*^9, {3.827051919136755*^9, 3.827051922032148*^9}, {
   3.827084560330988*^9, 3.8270845764685173`*^9}, {3.8270846164597063`*^9, 
   3.8270846226907177`*^9}, {3.8270847609659348`*^9, 3.827084789224317*^9}, {
   3.827084860237461*^9, 3.827084875869687*^9}, {3.8270849147923403`*^9, 
   3.827084916697763*^9}, {3.827085352593985*^9, 3.827085413400009*^9}, {
   3.827085468121048*^9, 3.827085491210265*^9}, {3.827085866489915*^9, 
   3.827085878444303*^9}, {3.8270860226066923`*^9, 3.827086033745594*^9}, 
   3.827086073127687*^9, {3.827109394478631*^9, 3.827109422501514*^9}, {
   3.82710984957788*^9, 3.8271098684109707`*^9}, 3.827110562688636*^9, {
   3.8271118144657917`*^9, 3.827111958876506*^9}, {3.827112858738752*^9, 
   3.827112879791853*^9}, 3.827117980076353*^9, {3.8271223379764967`*^9, 
   3.827122483545432*^9}, 3.827122720329205*^9, {3.827122759647332*^9, 
   3.8271228158575363`*^9}},
 CellLabel->
  "(Debug) In[141]:=",ExpressionUUID->"4cc13a2b-1b40-4570-8a9a-991770243963"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
WireMultipole: Magnetic Vector Potential, Magnetic Induction, and Magnetic \
Induction Gradient\
\>", "Subsection",
 CellChangeTimes->{{3.826618734931808*^9, 3.826618748221367*^9}, {
  3.827047076911104*^9, 3.827047148729266*^9}, {3.827051706800112*^9, 
  3.827051718629752*^9}, {3.827122313515842*^9, 3.827122316178751*^9}, {
  3.8271225011982117`*^9, 3.827122503407341*^9}, {3.8276432060835867`*^9, 
  3.827643207932131*^9}},ExpressionUUID->"a94517e3-a68a-472e-8d2a-\
5173ae9aed36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MagneticVectorPotential", "[", 
     RowBox[{
      RowBox[{"p", ":", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
      RowBox[{"MultipoleSegment", "[", 
       RowBox[{
        RowBox[{"VectorPotentialMultipole", "[", 
         RowBox[{
          RowBox[{"cg", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", "lim1_", ",", 
          "lim2_", ",", "mp_List"}], "]"}], ",", 
        RowBox[{"WireSegment", "[", 
         RowBox[{
          RowBox[{"positions", ":", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"left", ":", 
              RowBox[{"{", 
               RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
             RowBox[{"right", ":", 
              RowBox[{"{", 
               RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "}"}]}], ",", 
          "current_", ",", "color_"}], "]"}]}], "]"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "LineSegment", ",", "t", ",", "s", ",", "n", ",", "rAbs", ",", 
        "\[Phi]"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
        RowBox[{"LineSegment", "[", 
         RowBox[{
          RowBox[{"start", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], ",", 
          RowBox[{"end", ":", 
           RowBox[{"{", 
            RowBox[{"_", ",", "_", ",", "_"}], "}"}]}]}], "]"}], ":=", 
        RowBox[{"Block", "[", 
         RowBox[{
          RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"v", "=", 
            RowBox[{"end", "-", "start"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"rAbs", "=", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"p", "-", "cg"}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{"p", "-", "cg"}], ")"}]}]]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"t", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"RotationMatrix", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "v"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"rAbs", ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "9"}]]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"\[Phi]", "=", 
               RowBox[{"VectorAngle", "[", 
                RowBox[{
                 RowBox[{"p", "-", "cg"}], ",", "v"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"s", ".", 
               RowBox[{"multipoleWireSegmentMagneticVectorPotential", "[", 
                RowBox[{"rAbs", ",", "\[Phi]", ",", "mp"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"s", ".", 
              RowBox[{"NormalWireSegmentMagneticVectorPotential", "[", 
               RowBox[{
                RowBox[{"t", ".", 
                 RowBox[{"(", 
                  RowBox[{"p", "-", "start"}], ")"}]}], ",", 
                SqrtBox[
                 RowBox[{"v", ".", "v"}]]}], "]"}]}]}], "\[IndentingNewLine]",
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]], " ", "current", " ", 
        RowBox[{"LineSegment", "[", 
         RowBox[{"left", ",", "right"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"multipoleWireSegmentMagneticVectorPotential", "[", 
     RowBox[{"r_", ",", "\[Phi]_", ",", 
      RowBox[{"multipole", ":", 
       RowBox[{"{", "__", "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "multipole", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              SuperscriptBox[
               RowBox[{"(", "r", ")"}], 
               RowBox[{"-", "#"}]], ")"}], "&"}], "/@", 
            RowBox[{"Range", "[", "n", "]"}]}], ")"}], ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "[", "\[Phi]", "]"}], ")"}], "&"}], "/@", 
            "multipole"}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalWireSegmentMagneticVectorPotential", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}], ",", "end_"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"ArcSinh", "[", 
        RowBox[{
         RowBox[{"-", "z"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}], "+", 
      RowBox[{"ArcSinh", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"end", "-", "z"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}]}], "]"}]}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826425881649251*^9, 3.826425887415029*^9}, {
   3.826426163828909*^9, 3.826426204918536*^9}, {3.826426364470594*^9, 
   3.826426414505369*^9}, {3.82642645928249*^9, 3.826426460219088*^9}, {
   3.826426501320942*^9, 3.826426873866972*^9}, {3.826427096162849*^9, 
   3.826427150632983*^9}, {3.8264300910621967`*^9, 3.826430121964252*^9}, {
   3.826430158963087*^9, 3.826430164208881*^9}, {3.8264307248457537`*^9, 
   3.826430957678555*^9}, {3.826431149369831*^9, 3.826431448770825*^9}, {
   3.826431481342223*^9, 3.826431643440987*^9}, {3.826431683011999*^9, 
   3.826431787341611*^9}, {3.826431841636047*^9, 3.826431972283352*^9}, {
   3.826432077655445*^9, 3.82643218531507*^9}, {3.8264322890553303`*^9, 
   3.826432402867196*^9}, {3.8264324673643227`*^9, 3.826432482432506*^9}, {
   3.8264325165794983`*^9, 3.826432554067245*^9}, {3.826432645150341*^9, 
   3.82643266045575*^9}, {3.826432825638447*^9, 3.82643286203055*^9}, {
   3.826432895016622*^9, 3.826432984743037*^9}, {3.826433231856094*^9, 
   3.82643327519024*^9}, {3.826433316421152*^9, 3.826433392334961*^9}, {
   3.8264335835423737`*^9, 3.8264336545382023`*^9}, {3.826433843783968*^9, 
   3.826433845228978*^9}, {3.826434028358891*^9, 3.826434061709379*^9}, {
   3.826434190783614*^9, 3.826434251063692*^9}, {3.8264342821884403`*^9, 
   3.82643429982238*^9}, {3.826436622054503*^9, 3.826437248031039*^9}, {
   3.826437281731391*^9, 3.8264373628164062`*^9}, {3.826437426402619*^9, 
   3.8264375142571573`*^9}, 3.826437962190831*^9, 3.826438059818245*^9, {
   3.826438793689322*^9, 3.826438794148703*^9}, {3.82643987265486*^9, 
   3.826439924453574*^9}, {3.8264423976057*^9, 3.826442404920055*^9}, {
   3.826442478379002*^9, 3.826442486594645*^9}, 3.826442912566794*^9, {
   3.826443824102971*^9, 3.826443899859942*^9}, 3.82652599399617*^9, {
   3.826526030033456*^9, 3.826526054479588*^9}, 3.826526094904339*^9, {
   3.82652619665186*^9, 3.8265263578664618`*^9}, {3.8265264943235826`*^9, 
   3.82652649811485*^9}, 3.826526545115197*^9, {3.826526590315818*^9, 
   3.8265266150068207`*^9}, {3.826526696748489*^9, 3.8265267213942738`*^9}, {
   3.826527296939608*^9, 3.8265272990886*^9}, {3.826527342547702*^9, 
   3.82652734724512*^9}, {3.8265273814163094`*^9, 3.826527454065537*^9}, {
   3.826527637850943*^9, 3.8265276981474113`*^9}, {3.826527908664817*^9, 
   3.826527948116226*^9}, {3.8265281278991003`*^9, 3.82652813880868*^9}, {
   3.826528472549402*^9, 3.826528527910671*^9}, {3.8265286619025803`*^9, 
   3.826528694584173*^9}, {3.826528853408885*^9, 3.826528857901701*^9}, {
   3.8265289871128683`*^9, 3.826528988496399*^9}, {3.826529241155726*^9, 
   3.826529311565195*^9}, {3.8265293978739433`*^9, 3.8265294345874043`*^9}, {
   3.8265327982114897`*^9, 3.82653282045583*^9}, {3.8265328524046307`*^9, 
   3.8265329409827423`*^9}, {3.826532986159115*^9, 3.8265330083367434`*^9}, {
   3.8265330451130257`*^9, 3.8265331217952023`*^9}, {3.826533172402474*^9, 
   3.8265332559538927`*^9}, {3.8265883082709913`*^9, 3.826588316449109*^9}, {
   3.826588376415659*^9, 3.826588511742834*^9}, {3.826588607645112*^9, 
   3.826588619050035*^9}, {3.826593298764576*^9, 3.8265933398192787`*^9}, {
   3.826593373977886*^9, 3.826593375297575*^9}, {3.826593495133297*^9, 
   3.826593495920891*^9}, {3.8265935661538763`*^9, 3.826593644973813*^9}, {
   3.826593706323701*^9, 3.826593707562087*^9}, 3.8265938071776667`*^9, {
   3.82659384058071*^9, 3.82659385541087*^9}, {3.826593951309198*^9, 
   3.8265939773800573`*^9}, {3.826594032273097*^9, 3.82659404065749*^9}, 
   3.826594086542289*^9, {3.826594194916761*^9, 3.82659421951794*^9}, {
   3.826594295490637*^9, 3.826594299874168*^9}, {3.826594336124802*^9, 
   3.8265943416899357`*^9}, {3.826594399398685*^9, 3.826594420580221*^9}, {
   3.8265946219519863`*^9, 3.826594625515436*^9}, {3.826594700134885*^9, 
   3.826594710944892*^9}, {3.82659482595398*^9, 3.8265950318576612`*^9}, 
   3.826596058007595*^9, {3.826596220601017*^9, 3.826596259860589*^9}, {
   3.826596413694784*^9, 3.8265964286149054`*^9}, {3.826596459044677*^9, 
   3.826596488651795*^9}, {3.826596533905051*^9, 3.826596584609105*^9}, {
   3.826596662243821*^9, 3.826596663606683*^9}, {3.826596698942787*^9, 
   3.826596733012887*^9}, {3.826596774222438*^9, 3.8265967767181*^9}, {
   3.8265968069022713`*^9, 3.82659684715305*^9}, {3.826596944959642*^9, 
   3.826596974103281*^9}, {3.826597045863515*^9, 3.826597082587865*^9}, 
   3.826597306804654*^9, 3.8265975209543133`*^9, {3.8265996888883677`*^9, 
   3.826599738574442*^9}, {3.82660994755969*^9, 3.8266099490726843`*^9}, {
   3.826618890030408*^9, 3.82661892250078*^9}, {3.826618996166655*^9, 
   3.826619178609746*^9}, {3.826619275260416*^9, 3.8266192771049137`*^9}, 
   3.826619519348379*^9, {3.826619603629052*^9, 3.826619606259326*^9}, {
   3.826619644085108*^9, 3.826619909925531*^9}, {3.826619943923853*^9, 
   3.826619947947033*^9}, {3.8266201369562798`*^9, 3.826620761695068*^9}, 
   3.826620795470976*^9, {3.826621163272064*^9, 3.826621170210453*^9}, {
   3.8266212346744947`*^9, 3.826621319513712*^9}, {3.8266216724332943`*^9, 
   3.8266217390859423`*^9}, {3.826622191256221*^9, 3.826622282382012*^9}, 
   3.826622317299947*^9, {3.826622375745596*^9, 3.8266223839041147`*^9}, {
   3.826622782022027*^9, 3.826622811225395*^9}, 3.826623417095297*^9, {
   3.8268701590245733`*^9, 3.826870165022127*^9}, {3.8268702099265003`*^9, 
   3.826870212110227*^9}, {3.8268708634202414`*^9, 3.826870866747285*^9}, {
   3.826871422508572*^9, 3.826871428910502*^9}, {3.826871469356607*^9, 
   3.826871524332797*^9}, {3.826874563076358*^9, 3.826874656757756*^9}, {
   3.82687480369709*^9, 3.826874819621188*^9}, {3.8270457582311487`*^9, 
   3.827045773541175*^9}, {3.827045818025771*^9, 3.827045827017761*^9}, {
   3.8270458660129137`*^9, 3.827045891237954*^9}, {3.827045926871814*^9, 
   3.827045958485376*^9}, {3.827046001320238*^9, 3.8270460089847517`*^9}, {
   3.827046164352229*^9, 3.8270463588930902`*^9}, {3.827046390244177*^9, 
   3.8270464306299667`*^9}, {3.827046478716262*^9, 3.827046481340938*^9}, {
   3.827046681167157*^9, 3.827046684398295*^9}, 3.827643261367017*^9, {
   3.8276433062002363`*^9, 3.827643372838089*^9}, {3.8276434396679573`*^9, 
   3.8276435200390263`*^9}, {3.827644328583432*^9, 3.827644329360413*^9}, {
   3.8276445044574423`*^9, 3.827644512795632*^9}, {3.827644695739788*^9, 
   3.82764471088132*^9}, {3.827644752695444*^9, 3.827644760713189*^9}, 
   3.827644794249804*^9, {3.827644851336677*^9, 3.8276449131768436`*^9}, {
   3.82764497076575*^9, 3.8276449859815483`*^9}, {3.8276450215804253`*^9, 
   3.827645132039885*^9}, {3.827645170952498*^9, 3.827645382803952*^9}, {
   3.827645456024447*^9, 3.827645517966317*^9}, {3.827645577579273*^9, 
   3.8276456335028543`*^9}, {3.827645673986759*^9, 3.827645683026478*^9}, {
   3.827645771975651*^9, 3.8276457769983683`*^9}, {3.8276458702403307`*^9, 
   3.827645896550425*^9}, {3.827645929943948*^9, 3.827645940430829*^9}, 
   3.8276460068853693`*^9, 3.8276460785583067`*^9, {3.827646109295583*^9, 
   3.8276461146936903`*^9}, {3.827646367450704*^9, 3.8276463736762447`*^9}, 
   3.8276552778567543`*^9, 3.8276553158723993`*^9, 3.8276553866002493`*^9, {
   3.827655430282799*^9, 3.827655452469501*^9}, {3.827655923290016*^9, 
   3.827655991763959*^9}, {3.827656031684329*^9, 3.827656055815186*^9}, {
   3.8276560913694267`*^9, 3.82765611554895*^9}, 3.827656155592613*^9, {
   3.827656188518169*^9, 3.8276561890522842`*^9}, {3.827656303092308*^9, 
   3.827656326536521*^9}, {3.827656359179541*^9, 3.8276563987378674`*^9}, {
   3.827656532475485*^9, 3.827656654609424*^9}, {3.82765669997545*^9, 
   3.8276568565535383`*^9}, {3.82765689294855*^9, 3.827656894702692*^9}, {
   3.827657014298987*^9, 3.827657072835361*^9}, {3.827657118864821*^9, 
   3.827657120950032*^9}, {3.827657172945949*^9, 3.827657184446411*^9}, {
   3.827657236296039*^9, 3.827657247844584*^9}, {3.827657376204124*^9, 
   3.82765737951397*^9}, 3.827657436995399*^9, {3.827657754873395*^9, 
   3.827657781000765*^9}, {3.82765781620262*^9, 3.827657822594882*^9}, {
   3.827657896985695*^9, 3.827657902554369*^9}, {3.8276580338667583`*^9, 
   3.8276580386628647`*^9}, {3.827658087477556*^9, 3.8276580997962933`*^9}, 
   3.8276581419289837`*^9, 3.8276585982062683`*^9, {3.827658820164132*^9, 
   3.827658827734787*^9}, {3.827659639500132*^9, 3.827659662848034*^9}, 
   3.8276597671933327`*^9, {3.827659858360067*^9, 3.8276598589028883`*^9}, 
   3.827659928685588*^9, {3.827660104774663*^9, 3.82766010495144*^9}, {
   3.827660772170459*^9, 3.827660783172477*^9}, 3.827661361630492*^9, 
   3.827661414340116*^9},ExpressionUUID->"3b873650-dd0b-4d97-a788-\
5ba55be73873"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1000, 1012},
WindowMargins->{{6, Automatic}, {-5, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 341, 5, 98, "Title",ExpressionUUID->"57e47aa5-7823-4734-8141-ff524fd090ed"],
Cell[924, 29, 180, 3, 31, "Author",ExpressionUUID->"0a82bfa3-dd50-4edf-8142-008798979813"],
Cell[CellGroupData[{
Cell[1129, 36, 5886, 155, 283, "Input",ExpressionUUID->"a035373d-97c2-4e0e-b3e9-26dbba22d4ac"],
Cell[7018, 193, 2217, 50, 354, "Output",ExpressionUUID->"e7962912-5e5d-4f09-a947-92531aacd35e"]
}, {2}]],
Cell[CellGroupData[{
Cell[9269, 248, 203, 4, 69, "Chapter",ExpressionUUID->"5a3e36a5-c5a2-404c-a4c5-5930e69c8bd8"],
Cell[9475, 254, 575, 18, 311, "Text",ExpressionUUID->"00df9528-5e65-4011-8bde-279622ded739"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10087, 277, 151, 3, 69, "Chapter",ExpressionUUID->"e20fa466-8504-4b14-af6d-104f7a9eccdc"],
Cell[CellGroupData[{
Cell[10263, 284, 219, 4, 67, "Section",ExpressionUUID->"0ce60eff-e4c5-44fd-aa12-d993c7590615"],
Cell[10485, 290, 3176, 45, 46, "Input",ExpressionUUID->"f3a404b4-0017-4116-b981-321c7a40ed54",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[13686, 339, 6175, 90, 247, "Input",ExpressionUUID->"41bbb72c-1aca-412e-8f5e-ab6667bbd6de",
 InitializationCell->True],
Cell[19864, 431, 492, 11, 24, "Message",ExpressionUUID->"0a80e8b1-73e9-4f6c-a88e-04c59e8b5adc"]
}, Open  ]],
Cell[20371, 445, 226, 4, 54, "Subsection",ExpressionUUID->"7dcf11fb-5eab-458c-bbd2-6dc4ea65345f"],
Cell[CellGroupData[{
Cell[20622, 453, 268, 4, 38, "Subsection",ExpressionUUID->"e8d9f847-c066-4a31-b0a2-db727e7b61fd"],
Cell[CellGroupData[{
Cell[20915, 461, 3574, 53, 79, "Input",ExpressionUUID->"df74079b-22cc-457e-9ad7-e89ed549a642",
 InitializationCell->True],
Cell[24492, 516, 493, 11, 24, "Message",ExpressionUUID->"80534342-525f-4cf3-b453-4f661e6bf504"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25022, 532, 308, 5, 45, "Subsubsection",ExpressionUUID->"d581de2c-533a-407a-90ec-4cec3b94c940",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[25333, 539, 5718, 83, 131, "Input",ExpressionUUID->"9683fd6e-a31c-4e48-bc61-687b3fa95307",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[31054, 624, 5528, 79, 173, "Input",ExpressionUUID->"1d401c5e-f5ac-4a06-afd3-5c7e3846f78d",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[36585, 705, 5010, 72, 131, "Input",ExpressionUUID->"4456894a-abcb-4159-b62a-aaebaf3e18b4",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[41598, 779, 4780, 69, 89, "Input",ExpressionUUID->"6b8c7a91-507e-4bfe-a8ee-efe2a20edfc9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[46393, 851, 497, 11, 24, "Message",ExpressionUUID->"3f7d999c-262f-4c9d-be06-7774f860ccd5"],
Cell[46893, 864, 3530, 53, 46, "Input",ExpressionUUID->"f533156b-7fb3-4ca4-803b-a401a3dcf823",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[50426, 919, 493, 11, 24, "Message",ExpressionUUID->"469a7682-98c5-4280-863c-ba6cbd59a06b"],
Cell[CellGroupData[{
Cell[50944, 934, 3544, 53, 46, "Input",ExpressionUUID->"86c66f95-6aef-44ea-a7cf-8e1a071f1aef",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[54491, 989, 5638, 81, 131, "Input",ExpressionUUID->"e131cbe1-4d54-4ccb-8957-427f8f85c595",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[60144, 1073, 494, 11, 24, "Message",ExpressionUUID->"e4d06b8c-fc82-4302-b42b-077b54fdc928"],
Cell[CellGroupData[{
Cell[60663, 1088, 4238, 61, 89, "Input",ExpressionUUID->"61f90669-0900-47e0-b5fc-6b4a58cbbe86",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[64904, 1151, 4918, 71, 110, "Input",ExpressionUUID->"28d475b7-8fdb-40f1-9ed0-6dfa62d25f7f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True],
Cell[69825, 1224, 8163, 123, 668, "Input",ExpressionUUID->"06691fa0-5e71-4194-b1c5-8ea80e16b498",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 InitializationCell->True]
}, Open  ]],
Cell[78003, 1350, 508, 11, 24, "Message",ExpressionUUID->"22331b6a-b1f1-40c8-976c-2057f58192e7"],
Cell[78514, 1363, 507, 11, 24, "Message",ExpressionUUID->"c184371d-d96b-4820-90f9-2707d960a810"],
Cell[79024, 1376, 500, 11, 24, "Message",ExpressionUUID->"819ea485-1b12-4e12-ac37-452869be5275"],
Cell[CellGroupData[{
Cell[79549, 1391, 202, 3, 45, "Subsubsection",ExpressionUUID->"c6ce2843-591c-4595-9525-fd47a996d64b"],
Cell[CellGroupData[{
Cell[79776, 1398, 6590, 102, 131, "Input",ExpressionUUID->"718a112d-0282-4c97-bdbe-64664f568998",
 InitializationCell->True],
Cell[86369, 1502, 497, 11, 70, "Message",ExpressionUUID->"1d290950-6a0f-480d-a7e6-88c8b3d34b2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86903, 1518, 3457, 51, 46, "Input",ExpressionUUID->"30b83b6c-c906-4e16-ad4c-24339f089744",
 InitializationCell->True],
Cell[90363, 1571, 501, 11, 70, "Message",ExpressionUUID->"3d566730-9a57-4f49-8d97-61b62a5aac8f"]
}, Open  ]],
Cell[90879, 1585, 5844, 84, 173, "Input",ExpressionUUID->"21cdad01-5032-4672-b754-06a74f5baa56",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[96748, 1673, 7762, 123, 110, "Input",ExpressionUUID->"23775fd1-d8a8-40d9-b4c3-fba1c316a9bd",
 InitializationCell->True],
Cell[104513, 1798, 501, 11, 70, "Message",ExpressionUUID->"b4b7ac8a-8d59-4929-ae0d-abf7211905ac"]
}, Open  ]],
Cell[105029, 1812, 3599, 53, 46, "Input",ExpressionUUID->"c360bb40-ba36-4518-9316-ec2c1391ac3d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[108653, 1869, 3607, 53, 46, "Input",ExpressionUUID->"b77db501-2e51-46f7-99e4-6f7cb7b925dd",
 InitializationCell->True],
Cell[112263, 1924, 504, 11, 70, "Message",ExpressionUUID->"c825032a-36c6-4e87-97e4-775eeb030991"]
}, Open  ]],
Cell[112782, 1938, 4965, 73, 152, "Input",ExpressionUUID->"ebd59fa7-b9d4-422a-82df-8d15d5bada93",
 InitializationCell->True],
Cell[117750, 2013, 3746, 55, 46, "Input",ExpressionUUID->"b41de1b5-3e3e-4cbf-8b67-1a1415e505ac",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[121521, 2072, 3803, 55, 46, "Input",ExpressionUUID->"ca9466b3-3508-4ace-aa81-0c8f7f0721f7",
 InitializationCell->True],
Cell[125327, 2129, 495, 11, 70, "Message",ExpressionUUID->"405c772a-891e-41ec-b536-866101f11845"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125859, 2145, 4480, 65, 46, "Input",ExpressionUUID->"5c067405-b2eb-4bb3-aaf7-0eb9f98ecffe",
 InitializationCell->True],
Cell[130342, 2212, 495, 11, 70, "Message",ExpressionUUID->"93301cfb-6204-4c1c-85b2-ed81bc492800"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130874, 2228, 4585, 65, 173, "Input",ExpressionUUID->"ca94f182-d985-4023-8e16-1a6aea658d8b",
 InitializationCell->True],
Cell[135462, 2295, 502, 11, 70, "Message",ExpressionUUID->"05df8d90-039d-4e1c-a2fe-35217f4fb929"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[136013, 2312, 205, 3, 37, "Subsubsection",ExpressionUUID->"5e336881-3802-4f47-bb0a-4fb04b2fb366"],
Cell[136221, 2317, 5472, 82, 110, "Input",ExpressionUUID->"906f7daa-5a93-4f0d-aedc-85eb61f40e4a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[141730, 2404, 254, 4, 37, "Subsubsection",ExpressionUUID->"c2f2bdfe-269b-4702-953d-3d5701cffa5e"],
Cell[141987, 2410, 3561, 52, 46, "Input",ExpressionUUID->"c0278a5f-0b64-4e62-9b07-f6f79299df36",
 InitializationCell->True],
Cell[145551, 2464, 5376, 78, 131, "Input",ExpressionUUID->"3a9df5fb-dc08-468e-b5bc-0baa24bd1f98",
 InitializationCell->True],
Cell[150930, 2544, 3587, 52, 46, "Input",ExpressionUUID->"7ba05aec-d329-4857-9b65-41d72bedfca3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[154542, 2600, 3572, 52, 46, "Input",ExpressionUUID->"99d24085-dd32-43c4-9c3a-f85864d1094c",
 InitializationCell->True],
Cell[158117, 2654, 493, 11, 70, "Message",ExpressionUUID->"3e96b379-ebd4-4322-abe8-347df0cdb40f"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158683, 2673, 162, 3, 67, "Section",ExpressionUUID->"ae19a15a-52de-4a74-bce5-765cc0731219"],
Cell[158848, 2678, 3168, 45, 46, "Input",ExpressionUUID->"5d4dca37-678d-4f9e-ab41-f7fd8e046d10",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[162041, 2727, 231, 4, 54, "Subsection",ExpressionUUID->"33bf73fd-6453-4b6b-b791-c5fd7b46c640"],
Cell[162275, 2733, 4952, 105, 236, "Input",ExpressionUUID->"2425fef0-9479-4375-ba5b-f28dfc0a4cd7",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[167264, 2843, 190, 3, 54, "Subsection",ExpressionUUID->"3a884ca9-3d6e-43b9-a8da-31c2c4098478"],
Cell[167457, 2848, 8137, 189, 593, "Input",ExpressionUUID->"54c4845b-57be-4424-b5df-a1a3005d4802",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[175631, 3042, 187, 3, 38, "Subsection",ExpressionUUID->"89150d40-cf78-43d1-b9de-e7d4c938ce64"],
Cell[175821, 3047, 7163, 165, 530, "Input",ExpressionUUID->"345d52d2-eee9-4e41-8a02-eb7e0e96e9c7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[183021, 3217, 236, 4, 38, "Subsection",ExpressionUUID->"a2352fb1-f209-43a3-96bd-b80145502970"],
Cell[183260, 3223, 8068, 180, 551, "Input",ExpressionUUID->"1fce66ff-f8f4-4db9-90c8-5bcc24e7e4cf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[191365, 3408, 241, 4, 38, "Subsection",ExpressionUUID->"80ad9aaf-06b9-4131-bab1-46879d32e13b"],
Cell[191609, 3414, 2819, 44, 68, "Input",ExpressionUUID->"ee0626f7-5f24-45a2-b408-07747d889038",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[194465, 3463, 285, 4, 38, "Subsection",ExpressionUUID->"dba2ad8e-81c4-491b-9062-ccac61beccab"],
Cell[194753, 3469, 2828, 44, 68, "Input",ExpressionUUID->"e7f85461-1217-4c9c-91ed-8b598575868d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[197618, 3518, 279, 4, 38, "Subsection",ExpressionUUID->"046b1a30-3001-440e-af9e-197999a53490"],
Cell[197900, 3524, 5297, 114, 257, "Input",ExpressionUUID->"994984dd-86a5-4879-865d-e5c344fa1ba6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[203234, 3643, 391, 6, 38, "Subsection",ExpressionUUID->"6442e5d9-7b2e-4685-8dad-248668214ff6"],
Cell[203628, 3651, 348, 7, 58, "Text",ExpressionUUID->"d76ab578-b677-45a8-a20a-b305215d1b22"],
Cell[203979, 3660, 5028, 91, 257, "Input",ExpressionUUID->"2e4590b4-b455-4522-81d7-1b18c6586653",
 InitializationCell->True],
Cell[209010, 3753, 5170, 95, 236, "Input",ExpressionUUID->"69feb243-5dfe-402c-aeb5-ce224f7de301",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[214217, 3853, 430, 6, 38, "Subsection",ExpressionUUID->"5768c730-3ea7-4b20-911d-686cd7d1f5c9"],
Cell[214650, 3861, 471, 9, 58, "Text",ExpressionUUID->"5d9b22dd-2e7a-4e39-9849-80ee5d1cb6d2"],
Cell[215124, 3872, 10644, 222, 507, "Input",ExpressionUUID->"8cc1f17c-75af-4abc-99a2-232ea99e922e",
 InitializationCell->True],
Cell[225771, 4096, 1054, 26, 131, "Input",ExpressionUUID->"5068acfa-9ad0-415a-b67d-8fa0164709d3",
 InitializationCell->True],
Cell[226828, 4124, 1813, 46, 236, "Input",ExpressionUUID->"24e050c4-37fd-4b83-bd92-48488f0c32da",
 InitializationCell->True],
Cell[228644, 4172, 2033, 52, 299, "Input",ExpressionUUID->"d533c991-72df-400e-a49c-f984f245aaca",
 InitializationCell->True],
Cell[230680, 4226, 1200, 29, 194, "Input",ExpressionUUID->"eacf6f55-8783-4ee6-9eb4-df1b71e4325c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[231917, 4260, 226, 4, 54, "Subsection",ExpressionUUID->"8e7dbc06-969b-45af-b141-d315396cda22"],
Cell[232146, 4266, 3859, 66, 89, "Input",ExpressionUUID->"8dfb6ed4-8eae-453f-ba04-c9f3cdeb45d8",
 InitializationCell->True],
Cell[236008, 4334, 5175, 99, 194, "Input",ExpressionUUID->"53f18218-f44a-4ea2-ae3a-e24df118b7ad",
 InitializationCell->True],
Cell[241186, 4435, 7405, 162, 329, "Input",ExpressionUUID->"a8234be0-8ac7-4a12-b65c-1d4c66ec81f0",
 InitializationCell->True],
Cell[248594, 4599, 15439, 372, 824, "Input",ExpressionUUID->"340d345e-54ba-43ae-aefc-88cb6c137555",
 InitializationCell->True],
Cell[264036, 4973, 5587, 107, 215, "Input",ExpressionUUID->"fff88d41-3ff6-4aba-9b23-54689b7f600e",
 InitializationCell->True],
Cell[269626, 5082, 4450, 76, 131, "Input",ExpressionUUID->"55f86390-1f49-4117-95d7-a58df0670a07",
 InitializationCell->True],
Cell[274079, 5160, 4136, 67, 152, "Input",ExpressionUUID->"b007a946-1abd-45e8-a016-1b8f2ad3731c",
 InitializationCell->True],
Cell[278218, 5229, 4520, 73, 152, "Input",ExpressionUUID->"3737c94d-661e-403c-8bea-41e0745ce82b",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[282787, 5308, 248, 4, 67, "Section",ExpressionUUID->"27e8894e-7e63-453c-b01b-88dd90e6649c"],
Cell[CellGroupData[{
Cell[283060, 5316, 300, 7, 54, "Subsection",ExpressionUUID->"27155e7b-44db-4209-bbd3-c49661ddf021"],
Cell[283363, 5325, 599, 12, 127, "Text",ExpressionUUID->"3bbe6e78-2883-4c1a-a67e-356f4a4b98d1"],
Cell[283965, 5339, 9882, 190, 336, "Input",ExpressionUUID->"d322bf2a-3f52-451f-a245-44956e866b47",
 InitializationCell->True],
Cell[293850, 5531, 11381, 215, 395, "Input",ExpressionUUID->"4fbdc0c9-8902-4d34-b6f7-d153f3a98bf3",
 InitializationCell->True],
Cell[305234, 5748, 9441, 173, 334, "Input",ExpressionUUID->"1dc700b2-303e-41cc-909d-1e86ca3e1701",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[314712, 5926, 300, 7, 38, "Subsection",ExpressionUUID->"0fab3031-2551-4d14-91c6-f53430eb8a89"],
Cell[315015, 5935, 6723, 103, 89, "Input",ExpressionUUID->"8f1aa924-c559-4dda-bf24-6fd89087004a",
 InitializationCell->True],
Cell[321741, 6040, 16782, 388, 736, "Input",ExpressionUUID->"1508e008-7117-4a95-930e-7a103e920b8d",
 InitializationCell->True],
Cell[338526, 6430, 2965, 44, 68, "Input",ExpressionUUID->"c58b111b-6cbe-4c8e-b6ab-dfb95ae98378",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[341528, 6479, 297, 7, 38, "Subsection",ExpressionUUID->"f1308000-3686-4146-9b28-58375bb17e7f"],
Cell[341828, 6488, 459, 9, 58, "Text",ExpressionUUID->"898f471f-b474-4eba-b6ca-4e391f58f2ad"],
Cell[342290, 6499, 11972, 238, 599, "Input",ExpressionUUID->"fd391bd1-7151-40f7-8838-33aa85f85d16",
 InitializationCell->True],
Cell[354265, 6739, 14124, 301, 942, "Input",ExpressionUUID->"1cbda0bb-417c-484d-a7c6-8317392519cb",
 InitializationCell->True],
Cell[368392, 7042, 19178, 488, 1251, "Input",ExpressionUUID->"ac56d377-67d2-4050-9d97-b38c261e93ed",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[387607, 7535, 347, 7, 38, "Subsection",ExpressionUUID->"52788b74-e0fb-4de8-a1ff-e50eeda9252c"],
Cell[387957, 7544, 459, 9, 58, "Text",ExpressionUUID->"dd5a7007-381e-4d8f-b0db-5f396af3abdc"],
Cell[388419, 7555, 18019, 355, 921, "Input",ExpressionUUID->"608d3fe2-386b-458d-8a9d-1f1608af7f44",
 InitializationCell->True],
Cell[406441, 7912, 8974, 141, 131, "Input",ExpressionUUID->"04bda687-38fe-4e07-bfc0-4b7a1d089bb9",
 InitializationCell->True],
Cell[415418, 8055, 7701, 124, 131, "Input",ExpressionUUID->"c1736ab0-3324-429d-9dbf-568a316f2579",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[423156, 8184, 344, 7, 38, "Subsection",ExpressionUUID->"ff4cb068-a1b5-4fb1-b6db-25ad98f30ccf"],
Cell[423503, 8193, 7664, 124, 131, "Input",ExpressionUUID->"75e433a0-7aaa-4473-bc84-d748abcccb81",
 InitializationCell->True],
Cell[431170, 8319, 8918, 141, 131, "Input",ExpressionUUID->"190191f2-3c78-4baf-bb84-6c5583ca9a39",
 InitializationCell->True],
Cell[440091, 8462, 7643, 123, 131, "Input",ExpressionUUID->"1db18f4c-e81c-471c-b94e-79d39ebdb2b3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[447771, 8590, 351, 7, 38, "Subsection",ExpressionUUID->"fe79126f-c611-40f8-9023-4f8cdc2d4b7b"],
Cell[448125, 8599, 7648, 123, 131, "Input",ExpressionUUID->"77acc46e-b8dd-4660-b2ff-15648c5fd05b",
 InitializationCell->True],
Cell[455776, 8724, 8880, 140, 131, "Input",ExpressionUUID->"8bcec8bd-4340-4455-b231-00e31b5feda8",
 InitializationCell->True],
Cell[464659, 8866, 7613, 123, 131, "Input",ExpressionUUID->"7e06caa0-e533-4a27-92c4-71390cacede8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[472309, 8994, 343, 7, 38, "Subsection",ExpressionUUID->"670880d9-ccb7-412a-8bc8-ac958fcad2f8"],
Cell[472655, 9003, 420, 8, 58, "Text",ExpressionUUID->"4a5fe1bd-d166-43a9-ab0a-dcc97862e31b"],
Cell[473078, 9013, 10573, 198, 262, "Input",ExpressionUUID->"589bd1fe-7b2e-4889-8019-d10c43342f35",
 InitializationCell->True],
Cell[483654, 9213, 11421, 211, 243, "Input",ExpressionUUID->"2c02a8e2-a67a-4612-8a0a-09b40405f9d5",
 InitializationCell->True],
Cell[495078, 9426, 11215, 222, 278, "Input",ExpressionUUID->"996e3b5c-3d06-4f8d-b528-66124ed3b8dc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[506330, 9653, 391, 8, 38, "Subsection",ExpressionUUID->"ff56d509-d9bc-4936-b11e-42c0b2d66cc4"],
Cell[506724, 9663, 8014, 124, 152, "Input",ExpressionUUID->"0670c9be-3c7b-48f3-bf5e-39fcc7b81aa2",
 InitializationCell->True],
Cell[514741, 9789, 8149, 126, 132, "Input",ExpressionUUID->"d18dd4d8-5304-407f-8e04-e158431c80df",
 InitializationCell->True],
Cell[522893, 9917, 8020, 124, 152, "Input",ExpressionUUID->"2b46627a-4251-4e04-ac4b-9a72db923a7c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[530950, 10046, 445, 9, 38, "Subsection",ExpressionUUID->"7ecc7764-9e86-489a-947f-47abb231372c"],
Cell[531398, 10057, 8312, 130, 131, "Input",ExpressionUUID->"100a862d-9cce-4093-adf4-8cbf15fa20fb",
 InitializationCell->True],
Cell[539713, 10189, 8302, 130, 131, "Input",ExpressionUUID->"6431e6ac-fa16-4feb-87ce-875274ea1062",
 InitializationCell->True],
Cell[548018, 10321, 8318, 130, 131, "Input",ExpressionUUID->"4cc13a2b-1b40-4570-8a9a-991770243963",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[556373, 10456, 494, 9, 38, "Subsection",ExpressionUUID->"a94517e3-a68a-472e-8d2a-5173ae9aed36"],
Cell[556870, 10467, 14790, 285, 722, "Input",ExpressionUUID->"3b873650-dd0b-4d97-a788-5ba55be73873",
 InitializationCell->True]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

